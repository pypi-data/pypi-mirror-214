Metadata-Version: 2.1
Name: info-chunks-to-embeddings
Version: 1.0.1
Description-Content-Type: text/markdown
Requires-Dist: torch
Requires-Dist: sentence-transformers
Requires-Dist: argparse

# info_chunks_to_embeddings.py
info_chunks_to_embeddings.py æ˜¯ä¸€å€‹å°‡ JSON æª”æ¡ˆè½‰æ›ç‚ºèªå¥åµŒå…¥çš„å·¥å…·ã€‚å®ƒä½¿ç”¨ SentenceTransformer æ¨¡å‹å°‡ JSON æ–‡ä»¶ä¸­çš„å…§å®¹è½‰æ›ç‚ºç›¸æ‡‰çš„èªå¥åµŒå…¥ï¼Œç„¶å¾Œå°‡é€™äº›åµŒå…¥ä¿å­˜åˆ°æŒ‡å®šçš„è³‡æ–™å¤¾ä¸­ã€‚

```
ğŸ”å‹•æ©Ÿ: 
. å¦‚æœåªæœ‰ .txt ç´”æ–‡å­—èˆ‡ .pt æ–‡å­—å‘é‡å½¼æ­¤å°ç…§çš„è©±ï¼Œå°‡ä¾†è‡ªç„¶èªè¨€ query æœƒä¸Ÿå¤±è©¦ç®—è¡¨åç¨±èˆ‡ worksheet åç¨±
. æˆ‘å€‘ç™¼æ˜äº†æŠŠ .csv æ¯ä¸€è¡Œéƒ½è½‰ä¸€å€‹æª”æ¡ˆ info_chunk.json é€™ç¨®æ ¼å¼
. info_chunk.json å¯ä»¥æœ€å¤§ç¨‹åº¦ä¿ç•™è©¦ç®—è¡¨åç¨±ã€worksheetåç¨±ã€ç¬¬å¹¾ row çš„è¨Šæ¯
. é€²è¡Œã€Œèªå¢ƒæ¢ç´¢ã€è‡ªç„¶èªè¨€æœå°‹æ™‚ï¼Œå¯ä»¥æŠ“å‡º info_chunk.json æ‰€æœ‰è³‡è¨Šè€Œä¸æ˜¯åªæœ‰ç•¶åˆçš„ .txt ç‰‡æ®µæ–‡å­—è€Œå·²
. è©¦ç®—è¡¨é¡å‹çš„æ–‡å­—çŸ¥è­˜åº«ï¼Œç”šè‡³å¯ä»¥æ ¹æ“š row ä¸Šä¸‹é †åºä¾†èª¿é–±æ›´å¤šç›¸é—œè³‡è¨Š
. info_chunk.json ä¸åªæ˜¯å¯ä»¥åƒ .csv è€Œå·², ä¹ŸåŒ…æ‹¬ .pdf .docx .xlsx ä¹Ÿéƒ½å¯ä»¥è½‰ info_chunk.json
. å› ç‚º 1 row 1 info_chunk.json, å¾ˆæ–¹ä¾¿å°±å¯ä»¥æŠŠä¸€å † info_chunk.json åˆ‡å‰² 20 ä»½ .zip åšåˆ†æ•£é‹ç®—
. info_chunks_to_embeddings.py æœ¬èº«å°šæœªåˆ†æ•£é‹ç®—, ä½†å¯æ“´å…… dist_info_chunks_to_embeddings.py
. æˆ‘å€‘åˆ»æ„æŠŠè¼¸å…¥èˆ‡è¼¸å‡ºæª”æ¡ˆåç¨±å¯ä»¥ç›´æ¥å°ç…§æ–¹ä¾¿é€é.ptèª¿é–±.json:
  doc-id_1H0NTLvF0oyURCw_YWBQJ8CkcL7pij5D_8zO_1gXMc5k_sha_0f813133_row_7.json
  doc-id_1H0NTLvF0oyURCw_YWBQJ8CkcL7pij5D_8zO_1gXMc5k_sha_0f813133_row_7.pt

ğŸ’£åœ°é›·: 
. è¦æ³¨æ„ info_chunk.json è£¡é¢å¿…é ˆåŒ…å«æœ‰ content æ¬„ä½æ‰èƒ½è½‰ embeddings .pt æª”æ¡ˆ
```

## å®‰è£
è¦å®‰è£ info_chunks_to_embeddingsï¼Œè«‹ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```
python3 -m pip install info-chunks-to-embeddings
```

## ä½¿ç”¨æ–¹æ³•
å°‡ JSON æª”æ¡ˆè½‰æ›ç‚ºåµŒå…¥ï¼ˆembeddingsï¼‰ï¼š
1. é¦–å…ˆï¼Œç¢ºä¿æ‚¨çš„ç³»çµ±ä¸­å·²å®‰è£äº† `sentence-transformers` åº«ã€‚ å¦‚æœå°šæœªå®‰è£…ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š
   ```
   pip install sentence-transformers
   ```
2. é‹è¡Œä»¥ä¸‹å‘½ä»¤å°‡æŒ‡å®šè³‡æ–™å¤¾ä¸­çš„ JSON æª”æ¡ˆè½‰æ›ç‚ºåµŒå…¥ä¸¦ä¿å­˜åˆ°åµŒå…¥è³‡æ–™å¤¾ä¸­ï¼š
   ```
   python info_chunks_to_embeddings.py --input-folder <json_files_path> --embeddings-folder <embeddings_folder_path>
   ```
   å…¶ä¸­ï¼Œ`<json_files_path>` æ˜¯è¦è½‰æ›çš„ JSON æª”æ¡ˆæ‰€åœ¨çš„è³‡æ–™å¤¾ï¼Œ`<embeddings_folder_path>` æ˜¯è¦ä¿å­˜ç”Ÿæˆçš„åµŒå…¥çš„è³‡æ–™å¤¾ã€‚

3. è‹¥è¦è¦†è“‹å·²ç¶“å­˜åœ¨çš„åµŒå…¥æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ `--force` é¸é …ï¼š
   ```
   python info_chunks_to_embeddings.py --input-folder <json_files_path> --embeddings-folder <embeddings_folder_path> --force
   ```
   
## ç¤ºä¾‹
ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„ JSON æª”æ¡ˆä½æ–¼ `~/my_json_files` è³‡æ–™å¤¾ä¸­ï¼Œä¸¦å¸Œæœ›å°‡ç”Ÿæˆçš„åµŒå…¥å­˜å„²åœ¨ `~/my_embeddings` è³‡æ–™å¤¾ä¸­ï¼Œå‰‡å¯ä»¥é‹è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```
python info_chunks_to_embeddings.py --input-folder ~/my_json_files --embeddings-folder ~/my_embeddings
```

## è¼¸å…¥è³‡æ–™æª”æ¡ˆ info_chunk.json èˆ‰ä¾‹ï¼ˆéœ€è¦æœ‰ content æ¬„ä½ï¼‰
```
{
    "uuid4": "f0dd55f0-229b-46d8-92af-e3c5e7275c52",
    "time": "2023-06-18T01:02:35.411700Z",
    "content": "é’æ˜¥ç—˜ é’æ˜¥ç—˜æ˜¯æœ€å¸¸è¦‹çš„çš®è†šå•é¡Œï¼Œæ˜¯çš®è„‚è…ºç™¼ç‚æ‰€è‡´ï¼Œè¡¨é¢ä¸Šå¯èƒ½æ˜¯ç´°èŒæ„ŸæŸ“ã€é»´èŒæ„ŸæŸ“ã€èŸèŸ²å¯„ç”Ÿï¼Œä½†æ›´æ·±å±¤ä¾†çœ‹ï¼Œæ˜¯æ€§è·çˆ¾è’™ä»£è¬ä¸è‰¯ã€è…¸é“èŒå¢å¤±è¡¡ã€èƒ°å³¶ç´ å¤ªé«˜ã€è‚è‡Ÿä»£è¬å—é˜»é€ æˆã€‚12-24æ­²é’å°‘å¹´ç››è¡Œç‡80%ï¼Œ25æ­²ä»¥ä¸Šé’å¹´ä¹Ÿé«˜é”50%ï¼Œå› ç‚ºæ­¤éšæ®µçš„çªå›ºé…®å’Œé›Œæ¿€ç´ åˆ†æ³Œæœ€å¤šã€‚ç†¬å¤œã€é«˜é†£é£²é£Ÿã€åŠ å·¥é£Ÿç‰©ï¼ˆå°¤å…¶æ˜¯åƒåœ¾é£Ÿç‰©ï¼‰ã€è‡‰éƒ¨è¡›ç”Ÿç¿’æ…£ä¸å¥½æˆ–éåº¦æ¸…æ½”ï¼Œéƒ½æœƒå¼•èµ·é’æ˜¥ç—˜ã€‚æ‰€ä»¥ï¼Œè¦å¾¹åº•è§£æ±ºé’æ˜¥ç—˜ä¸¦ä¸é›£ï¼Œä½†éœ€è¦æ¢è¨è‡ªå·±åˆ°åº•æ˜¯å“ªå€‹ç’°ç¯€å‡ºå•é¡Œã€‚",
    "type": "google_sheet",
    "sheet_id": "1H0NTLvF0oyURCw_YWBQJ8CkcL7pij5D_8zO_1gXMc5k",
    "sheet_name": "å¥åº·ç™¾ç§‘å•ç­”çŸ¥è­˜åº«",
    "worksheet_name": "å·¥ä½œè¡¨1",
    "download_time": "2023-06-18T00:57:05.222819Z",
    "download_filepath": "./data/users/boh/bohachu_gmail_com/google_sheet_downloader/2023-06-18/doc-id_1H0NTLvF0oyURCw_YWBQJ8CkcL7pij5D_8zO_1gXMc5k_sha_0f813133.csv",
    "row": 13
}
```
