{"version":3,"file":"listView.js","names":["Djblets","Config","ListView","Backbone","View","extend","tagName","className","defaultItemView","ListItemView","initialize","options","arguments","length","undefined","collection","model","ItemView","views","animateItems","once","listenTo","_addItem","_removeItem","_renderItems","getBody","$el","render","$listBody","trigger","item","animateItem","animate","view","fadeIn","append","push","_","find","without","fadeOut","remove","forEach","empty","each"],"sources":["../../../../../../static/djblets/js/configForms/views/listView.es6.js"],"sourcesContent":["/**\n * Display a list of items.\n *\n * This will render each item in a list, and update that list when the\n * items in the collection changes.\n *\n * It can also filter the displayed list of items.\n *\n * If loading the list through the API, this will display a loading indicator\n * until the items have been loaded.\n *\n * If 'options.animateItems' is true, then newly added or removed items will\n * be faded in/out.\n */\nDjblets.Config.ListView = Backbone.View.extend({\n    tagName: 'ul',\n    className: 'djblets-c-config-forms-list',\n    defaultItemView: Djblets.Config.ListItemView,\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object, optional):\n     *         The view options.\n     *\n     * Option Args:\n     *     ItemView (object):\n     *         The item view class to use. This argument defaults to\n     *         :js:attr:`defaultItemView`.\n     *\n     *     animateItems (boolean):\n     *         Whether or not items should be animated. This argument\n     *         defaults to ``false``.\n     */\n    initialize(options={}) {\n        const collection = this.model.collection;\n\n        this.ItemView = options.ItemView || this.defaultItemView;\n        this.views = [];\n        this.animateItems = !!options.animateItems;\n\n        this.once('rendered', () => {\n            this.listenTo(collection, 'add', this._addItem);\n            this.listenTo(collection, 'remove', this._removeItem);\n            this.listenTo(collection, 'reset', this._renderItems);\n        });\n    },\n\n    /**\n     * Return the body element.\n     *\n     * This can be overridden by subclasses if the list items should be\n     * rendered to a child element of this view.\n     *\n     * Returns:\n     *     jQuery:\n     *     Where the list view should be rendered.\n     */\n    getBody() {\n        return this.$el;\n    },\n\n    /**\n     * Render the list of items.\n     *\n     * This will loop through all items and render each one.\n     *\n     * Returns:\n     *     Djblets.Config.ListView:\n     *     This view.\n     */\n    render() {\n        this.$listBody = this.getBody();\n\n        this._renderItems();\n        this.trigger('rendered');\n\n        return this;\n    },\n\n    /**\n     * Create a view for an item and adds it.\n     *\n     * Args:\n     *     item (Backbone.Model):\n     *         The model to add.\n     *\n     *     collection (Backbone.Collection):\n     *         Ignored.\n     *\n     *     options (object, optional):\n     *         Options for adding the item.\n     *\n     * Option Args:\n     *     animate (boolean):\n     *         Whether or not to animate adding the item. This argument defaults\n     *         to ``true``.\n     */\n    _addItem(item, collection, options={}) {\n        const animateItem = (options.animate !== false);\n        const view = new this.ItemView({\n            model: item\n        });\n\n        view.render();\n\n        /*\n         * If this ListView has animation enabled, and this specific\n         * item is being animated (the default unless options.animate\n         * is false), we'll fade in the item.\n         */\n        if (this.animateItems && animateItem) {\n            view.$el.fadeIn();\n        }\n\n        this.$listBody.append(view.$el);\n        this.views.push(view);\n    },\n\n    /**\n     * Handle an item being removed from the collection.\n     *\n     * Removes the element from the list.\n     *\n     * Args:\n     *     item (Backbone.Model):\n     *         The model to remove.\n     *\n     *     collection (Backbone.Collection):\n     *         Ignored.\n     *\n     *     options (object, optional):\n     *         Options for removing the element.\n     *\n     * Option Args:\n     *     animate (boolean):\n     *         Whether or not the removal should be animated. This defaults\n     *         to ``true``.\n     */\n    _removeItem(item, collection, options={}) {\n        const animateItem = (options.animate !== false);\n        const view = _.find(this.views, view => view.model === item);\n\n        if (view) {\n            this.views = _.without(this.views, view);\n\n            /*\n             * If this ListView has animation enabled, and this specific\n             * item is being animated (the default unless options.animate\n             * is false), we'll fade out the item.\n             */\n            if (this.animateItems && animateItem) {\n                view.$el.fadeOut(function() {\n                    view.remove();\n                });\n            } else {\n                view.remove();\n            }\n        }\n    },\n\n    /**\n     * Render all items from the list.\n     */\n    _renderItems() {\n        this.views.forEach(function(view) {\n            view.remove();\n        });\n        this.views = [];\n        this.$listBody.empty();\n\n        this.model.collection.each(item => {\n            this._addItem(item, item.collection, {\n                animate: false\n            });\n        });\n    },\n});\n"],"mappings":"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"}