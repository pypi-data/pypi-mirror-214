{"version":3,"file":"pagesView.js","names":["Djblets","Config","PagesView","Backbone","View","extend","initialize","router","Router","routes","listenTo","_onPageChanged","_$activeNav","_$activePage","_preserveMessages","render","_$pageNavs","$","_$pages","eq","addClass","history","start","root","window","location","pathname","pageID","removeClass","length","navigate","find","attr","substr","trigger","replace","filter","remove"],"sources":["../../../../../../static/djblets/js/configForms/views/pagesView.es6.js"],"sourcesContent":["/**\n * Manages a collection of configuration pages.\n *\n * The primary job of this view is to handle sub-page navigation.\n * The actual page will contain several \"pages\" that are shown or hidden\n * depending on what the user has clicked on the sidebar.\n */\nDjblets.Config.PagesView = Backbone.View.extend({\n    /**\n     * Initialize the view.\n     *\n     * This will set up the router for handling page navigation.\n     */\n    initialize() {\n        this.router = new Backbone.Router({\n            routes: {\n                ':pageID': 'page'\n            }\n        });\n        this.listenTo(this.router, 'route:page', this._onPageChanged);\n\n        this._$activeNav = null;\n        this._$activePage = null;\n        this._preserveMessages = true;\n    },\n\n    /**\n     * Render the view.\n     *\n     * This will set the default page to be shown, and instruct Backbone\n     * to begin handling the routing.\n     *\n     * Returns:\n     *     Djblets.Config.PageView:\n     *     This view.\n     */\n    render() {\n        this._$pageNavs = this.$('.djblets-c-config-forms-page-nav__item');\n        this._$pages = this.$('.djblets-c-config-forms-subpage');\n\n        this._$activeNav = this._$pageNavs.eq(0).addClass('-is-active');\n        this._$activePage = this._$pages.eq(0).addClass('-is-active');\n\n        Backbone.history.start({\n            root: window.location.pathname,\n        });\n\n        return this;\n    },\n\n    /**\n     * Handle when the page changes.\n     *\n     * The sidebar will be updated to reflect the current active page,\n     * and the page will be shown.\n     *\n     * If navigating pages manually, any messages provided by the backend\n     * form will be removed. We don't do this the first time there's a\n     * navigation, as this will be called when first rendering the view.\n     *\n     * Args:\n     *     pageID (string):\n     *         The ID of the page that is becoming active.\n     */\n    _onPageChanged(pageID) {\n        this._$activeNav.removeClass('-is-active');\n        this._$activePage.removeClass('-is-active');\n\n        this._$activePage = $(`#page_${pageID}`);\n\n        if (this._$activePage.length === 0) {\n            /*\n             * If the requested page doesn't exist (for example, it might be\n             * hidden, or just typoed), load the first page instead.\n             */\n            this.router.navigate(\n                this._$pageNavs.find('a').attr('href').substr(1),\n                {\n                    trigger: true,\n                    replace: true\n                });\n        } else {\n            this._$activeNav =\n                this._$pageNavs\n                    .filter(`:has(a[href=\"#${pageID}\"])`)\n                    .addClass('-is-active');\n\n            this._$activePage.addClass('-is-active');\n\n            if (!this._preserveMessages) {\n                $('#messages').remove();\n            }\n\n            this._preserveMessages = false;\n        }\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,OAAO,CAACC,MAAM,CAACC,SAAS,GAAGC,QAAQ,CAACC,IAAI,CAACC,MAAM,CAAC;EAC5C;AACJ;AACA;AACA;AACA;EACIC,UAAUA,CAAA,EAAG;IACT,IAAI,CAACC,MAAM,GAAG,IAAIJ,QAAQ,CAACK,MAAM,CAAC;MAC9BC,MAAM,EAAE;QACJ,SAAS,EAAE;MACf;IACJ,CAAC,CAAC;IACF,IAAI,CAACC,QAAQ,CAAC,IAAI,CAACH,MAAM,EAAE,YAAY,EAAE,IAAI,CAACI,cAAc,CAAC;IAE7D,IAAI,CAACC,WAAW,GAAG,IAAI;IACvB,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,iBAAiB,GAAG,IAAI;EACjC,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIC,MAAMA,CAAA,EAAG;IACL,IAAI,CAACC,UAAU,GAAG,IAAI,CAACC,CAAC,CAAC,wCAAwC,CAAC;IAClE,IAAI,CAACC,OAAO,GAAG,IAAI,CAACD,CAAC,CAAC,iCAAiC,CAAC;IAExD,IAAI,CAACL,WAAW,GAAG,IAAI,CAACI,UAAU,CAACG,EAAE,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,YAAY,CAAC;IAC/D,IAAI,CAACP,YAAY,GAAG,IAAI,CAACK,OAAO,CAACC,EAAE,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,YAAY,CAAC;IAE7DjB,QAAQ,CAACkB,OAAO,CAACC,KAAK,CAAC;MACnBC,IAAI,EAAEC,MAAM,CAACC,QAAQ,CAACC;IAC1B,CAAC,CAAC;IAEF,OAAO,IAAI;EACf,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIf,cAAcA,CAACgB,MAAM,EAAE;IACnB,IAAI,CAACf,WAAW,CAACgB,WAAW,CAAC,YAAY,CAAC;IAC1C,IAAI,CAACf,YAAY,CAACe,WAAW,CAAC,YAAY,CAAC;IAE3C,IAAI,CAACf,YAAY,GAAGI,CAAC,CAAE,SAAQU,MAAO,EAAC,CAAC;IAExC,IAAI,IAAI,CAACd,YAAY,CAACgB,MAAM,KAAK,CAAC,EAAE;MAChC;AACZ;AACA;AACA;MACY,IAAI,CAACtB,MAAM,CAACuB,QAAQ,CAChB,IAAI,CAACd,UAAU,CAACe,IAAI,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,MAAM,CAAC,CAACC,MAAM,CAAC,CAAC,CAAC,EAChD;QACIC,OAAO,EAAE,IAAI;QACbC,OAAO,EAAE;MACb,CAAC,CAAC;IACV,CAAC,MAAM;MACH,IAAI,CAACvB,WAAW,GACZ,IAAI,CAACI,UAAU,CACVoB,MAAM,CAAE,iBAAgBT,MAAO,KAAI,CAAC,CACpCP,QAAQ,CAAC,YAAY,CAAC;MAE/B,IAAI,CAACP,YAAY,CAACO,QAAQ,CAAC,YAAY,CAAC;MAExC,IAAI,CAAC,IAAI,CAACN,iBAAiB,EAAE;QACzBG,CAAC,CAAC,WAAW,CAAC,CAACoB,MAAM,CAAC,CAAC;MAC3B;MAEA,IAAI,CAACvB,iBAAiB,GAAG,KAAK;IAClC;EACJ;AACJ,CAAC,CAAC"}