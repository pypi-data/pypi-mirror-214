import numpy as np

def convert_celsius(unit1, unit2):
    pass

UnitPrefixes = {
    'Y':        (1.0,        [ 24, 0, 0, 0, 0, 0, 0, 0, 0],  '1e24',                   'yotta'            ), 
    'Z':        (1.0,        [ 21, 0, 0, 0, 0, 0, 0, 0, 0],  '1e21',                   'zetta'            ), 
    'E':        (1.0,        [ 18, 0, 0, 0, 0, 0, 0, 0, 0],  '1e18',                   'exa'              ), 
    'P':        (1.0,        [ 15, 0, 0, 0, 0, 0, 0, 0, 0],  '1e15',                   'peta'             ), 
    'T':        (1.0,        [ 12, 0, 0, 0, 0, 0, 0, 0, 0],  '1e12',                   'tera'             ), 
    'G':        (1.0,        [  9, 0, 0, 0, 0, 0, 0, 0, 0],  '1e9',                    'giga'             ), 
    'M':        (1.0,        [  6, 0, 0, 0, 0, 0, 0, 0, 0],  '1e6',                    'mega'             ), 
    'k':        (1.0,        [  3, 0, 0, 0, 0, 0, 0, 0, 0],  '1e3',                    'kilo'             ), 
    'h':        (1.0,        [  2, 0, 0, 0, 0, 0, 0, 0, 0],  '1e2',                    'hecto'            ), 
    'da':       (1.0,        [  1, 0, 0, 0, 0, 0, 0, 0, 0],  '1e1',                    'deka'             ), 
    'd':        (1.0,        [ -1, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-1',                   'deci'             ), 
    'c':        (1.0,        [ -2, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-2',                   'centi'            ), 
    'm':        (1.0,        [ -3, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-3',                   'milli'            ), 
    'u':        (1.0,        [ -6, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-6',                   'micro'            ), 
    'n':        (1.0,        [ -9, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-9',                   'nano'             ), 
    'p':        (1.0,        [-12, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-12',                  'pico'             ), 
    'f':        (1.0,        [-15, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-15',                  'femto'            ), 
    'a':        (1.0,        [-18, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-18',                  'atto'             ), 
    'z':        (1.0,        [-21, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-21',                  'zepto'            ), 
    'y':        (1.0,        [-24, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-24',                  'yocto'            ), 
}                                                                                        
            
UnitBase = ['1e','m','g','s','K','C','cd','mol','rad']
            
UnitStandard = {
    # order
    '1e':       (1.0,        [  1, 0, 0, 0, 0, 0, 0, 0, 0],  None,                     'power of ten'     ),
    # physical units                            
    'm':        (1.0,        [  0, 1, 0, 0, 0, 0, 0, 0, 0],  None,                     'meter'            ),
    'g':        (1.0,        [  0, 0, 1, 0, 0, 0, 0, 0, 0],  None,                     'gram'             ),
    's':        (1.0,        [  0, 0, 0, 1, 0, 0, 0, 0, 0],  None,                     'second'           ),
    'K':        (1.0,        [  0, 0, 0, 0, 1, 0, 0, 0, 0],  None,                     'kelvin'           ),
    'C':        (1.0,        [  0, 0, 0, 0, 0, 1, 0, 0, 0],  None,                     'coulomb'          ),
    'cd':       (1.0,        [  0, 0, 0, 0, 0, 0, 1, 0, 0],  None,                     'candela'          ),
    # numerical units
    'mol':      (1.0,        [  0, 0, 0, 0, 0, 0, 0, 1, 0],  None,                     'mole'             ),
    'rad':      (1.0,        [  0, 0, 0, 0, 0, 0, 0, 0, 1],  None,                     'radian'           ),
    # Derived units
    # SI units                                                                                
    'sr':       (1.0,        [  0, 0, 0, 0, 0, 0, 0, 0, 2],  'rad2',                   'steradian'        ),
    'Hz':       (1.0,        [  0, 0, 0,-1, 0, 0, 0, 0, 0],  's-1',                    'hertz'            ),
    'N':        (1.0,        [  3, 1, 1,-2, 0, 0, 0, 0, 0],  'kg*m/s2',                'newton'           ),
    'Pa':       (1.0,        [  3,-1, 1,-2, 0, 0, 0, 0, 0],  'N/m2',                   'pascal'           ),
    'J':        (1.0,        [  3, 2, 1,-2, 0, 0, 0, 0, 0],  'N*m',                    'joule'            ),
    'W':        (1.0,        [  3, 2, 1,-3, 0, 0, 0, 0, 0],  'J/s',                    'watt'             ),
    'A':        (1.0,        [  0, 0, 0,-1, 0, 1, 0, 0, 0],  'C/s',                    'ampere'           ),
    'V':        (1.0,        [  3, 2, 1,-2, 0,-1, 0, 0, 0],  'J/C',                    'volt'             ),
    'F':        (1.0,        [ -3,-2,-1, 2, 0, 2, 0, 0, 0],  'C/V',                    'farad'            ),
    'Ohm':      (1.0,        [  3, 2, 1,-1, 0,-2, 0, 0, 0],  'V/A',                    'ohm'              ),
    'S':        (1.0,        [ -3,-2,-1, 1, 0, 2, 0, 0, 0],  'Ohm-1',                  'siemens'          ),
    'Wb':       (1.0,        [  3, 2, 1,-1, 0,-1, 0, 0, 0],  'V*s',                    'weber'            ),
    'T':        (1.0,        [  3, 0, 1,-1, 0,-1, 0, 0, 0],  'Wb/m2',                  'tesla'            ),
    'H':        (1.0,        [  3, 2, 1, 0, 0,-2, 0, 0, 0],  'Wb/A',                   'henry'            ),
    'lm':       (1.0,        [  0, 0, 0, 0, 0, 0, 1, 0, 2],  'cd*sr',                  'lumen'            ),
    'lx':       (1.0,        [  0,-2, 0, 0, 0, 0, 1, 0, 2],  'lm/m2',                  'lux'              ),
    'Bq':       (1.0,        [  0, 0, 0,-1, 0, 0, 0, 0, 0],  's-1',                    'becquerel'        ),
    'Gy':       (1.0,        [  0, 2, 0,-2, 0, 0, 0, 0, 0],  'J/kg',                   'gray'             ),
    'Sv':       (1.0,        [  0, 2, 0,-2, 0, 0, 0, 0, 0],  'J/kg',                   'sivert'           ),
    # CGS units                                                                               
    'dyn':      (1.0,        [ -2, 1, 1,-2, 0, 0, 0, 0, 0],  'g*cm/s2',                'dyne'             ),
    'erg':      (1.0,        [ -4, 2, 1,-2, 0, 0, 0, 0, 0],  'dyn*cm',                 'erg'              ),
    'G':        (1.0,        [ -1, 0, 1,-1, 0,-1, 0, 0, 0],  '1e-4*T',                 'Gauss'            ),
    # other derived units                                                                     
    'deg':      (1.745329,   [ -2, 0, 0, 0, 0, 0, 0, 0, 1],  '2*[pi]*rad/360',         'angle degree'     ),
    "'":        (2.908882,   [ -4, 0, 0, 0, 0, 0, 0, 0, 1],  'deg/60',                 'angle minute'     ),
    "''":       (4.848137,   [ -6, 0, 0, 0, 0, 0, 0, 0, 1],  "'/60",                   'angle second'     ),
    'l':        (1,          [ -3, 3, 0, 0, 0, 0, 0, 0, 0],  'dm3',                    'liter'            ),
    'L':        (1,          [ -3, 3, 0, 0, 0, 0, 0, 0, 0],  'l',                      'liter'            ),
    'ar':       (1,          [  2, 2, 0, 0, 0, 0, 0, 0, 0],  '100*m2',                 'are'              ),
    'min':      (6.0,        [  1, 0, 0, 1, 0, 0, 0, 0, 0],  '60*s',                   'minute'           ),
    'h':        (3.6,        [  3, 0, 0, 1, 0, 0, 0, 0, 0],  '60*min',                 'hour'             ),
    'd':        (8.64,       [  4, 0, 0, 1, 0, 0, 0, 0, 0],  '24*h',                   'day'              ),
    'a_t':      (3.155693,   [  7, 0, 0, 1, 0, 0, 0, 0, 0],  '365.24219*d',            'tropical year'    ),
    'a_j':      (3.155760,   [  7, 0, 0, 1, 0, 0, 0, 0, 0],  '365.25*d',               'Julian year'      ),
    'a_g':      (3.155695,   [  7, 0, 0, 1, 0, 0, 0, 0, 0],  '365.2425*d',             'Gregorian year'   ),
    'a':        (3.155760,   [  7, 0, 0, 1, 0, 0, 0, 0, 0],  'a_j',                    'year'             ),
    'eV':       (1.60217733, [-16, 2, 1,-2, 0, 0, 0, 0, 0],  '[e]*V',                  'electronvolt'     ),
    'au':       (1.49597870, [ 11, 1, 0, 0, 0, 0, 0, 0, 0],  '149597.870691*Mm',       'astr. unit'       ),
    'AU':       (1.49597870, [ 11, 1, 0, 0, 0, 0, 0, 0, 0],  'au',                     'astr. unit'       ),
    # natural units
    '[c]':      (2.99792458, [  8, 1, 0,-1, 0, 0, 0, 0, 0],  '299792458*m/s',          'velocity of light'),
    '[h]':      (6.626076,   [-31, 2, 1,-1, 0, 0, 0, 0, 0],  '6.6260755e-34*J*s',      'Planck const.'    ),
    '[k]':      (1.380658,   [-20, 2, 1,-2,-1, 0, 0, 0, 0],  '1.380658e-23*J/K',       'Boltzmann const.' ),
    '[eps_0]':  (8.854188,   [-15,-3,-1, 2, 0, 2, 0, 0, 0],  '8.854187817e-12*F/m',    'permit. of vac.'  ),
    '[mu_0]':   (1.256637,   [ -3, 1, 1, 0, 0,-2, 0, 0, 0],  '4*[pi]*1e-7*N/A2',       'permeab. of vac.' ),
    '[e]':      (1.60217733, [-19, 0, 0, 0, 0, 1, 0, 0, 0],  '1.60217733e-19*C',       'elem. charge'     ),
    '[m_e]':    (9.109390,   [-28, 0, 1, 0, 0, 0, 0, 0, 0],  '9.1093897e-28*g',        'electron mass'    ),
    '[m_p]':    (1.672623,   [-24, 0, 1, 0, 0, 0, 0, 0, 0],  '1.6726231e-24*g',        'proton mass'      ),
    '[G]':      (6.672590,   [-14, 3,-1,-2, 0, 0, 0, 0, 0],  '6.67259e-11*m3/(kg*s2)', 'grav. const.'     ),
    '[g]':      (9.806650,   [  0, 1, 0,-2, 0, 0, 0, 0, 0],  '9.80665*m/s2',           'grav. accel.'     ),
    'atm':      (1.013250,   [  8,-1, 1,-2, 0, 0, 0, 0, 0],  '101325*Pa',              'atm. pressure'    ),
    'ly':       (9.460730,   [ 15, 1, 0, 0, 0, 0, 0, 0, 0],  '[c]*a_j',                'light-year'       ),
    # dimensionless units
    '[pi]':     (np.pi,      [  0, 0, 0, 0, 0, 0, 0, 0, 0],  '3.141593',               'pi'               ),
    '[euler]':  (np.e,       [  0, 0, 0, 0, 0, 0, 0, 0, 0],  '2.718282',               "Euler's num."     ),
    '[N_A]':    (6.0221367,  [ 23, 0, 0, 0, 0, 0, 0, 0, 0],  '6.022137e23',            "Avogadro's num."  ),
    '%':        (1,          [ -2, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-2',                   'percent'          ),
    '[ppth]':   (1,          [ -3, 0, 0, 0, 0, 0, 0, 0, 0],  '1e-3',                   'promile'          ),
    # units defined by a nonlinear function
    'Cel':      (1,          [  0, 0, 0, 0, 1, 0, 0, 0, 0],  convert_celsius,          'Degree Celsius'   ),
}

def Convert_Arbitrary(quantity1, quantity2):
    conv = "_".join([quantity1.symbol_base, quantity2.symbol_base])
    if conv=="Cel_K":
        magnitude1 = quantity1.magnitude()
        magnitude2 = (magnitude1 + 273.15) / quantity2.magnitude()
    elif conv=="K_Cel":
        magnitude1 = quantity1.magnitude()
        magnitude2 = (magnitude1 - 273.15) / quantity2.magnitude()
    if magnitude2:
        quantity2.magnitude = magnitude2
        quantity2.base[0] = 0
        quantity2._rebase()
        return quantity2
    else:
        raise Exception(f"No conversion of arbitrary unit '{quantity1.symbol}' to '{quantity2.symbol}' was found.")
        
