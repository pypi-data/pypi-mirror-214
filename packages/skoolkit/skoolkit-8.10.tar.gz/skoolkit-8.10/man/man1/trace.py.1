.\" Man page generated from reStructuredText.
.
.TH "TRACE.PY" "1" "Jun 17, 2023" "8.10" "SkoolKit"
.SH NAME
trace.py \- simulate code execution in a 48K memory snapshot
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.sp
\fBtrace.py\fP [options] FILE
.SH DESCRIPTION
.sp
\fBtrace.py\fP simulates the execution of machine code in a 48K binary (raw
memory) file or a SNA, SZX or Z80 snapshot. If FILE is \(aq.\(aq, no snapshot is
loaded, and the RAM is left blank (all zeroes).
.SH OPTIONS
.INDENT 0.0
.TP
.B \-\-audio
Show a list of the delays (in T\-states) between changes in the state of the
ZX Spectrum speaker made by the code that was executed.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-depth \fIN\fP
Simplify audio delays to this depth (default: 2). When this option is given,
any sequence of delays up to length \fIN\fP that repeats is shown in a simplified
form. For example, if \fIN\fP is 3, the run of delay values [1, 2, 3, 1, 2, 3] is
reduced to [1, 2, 3]*2.
.UNINDENT
.INDENT 0.0
.TP
.B \-D\fP,\fB  \-\-decimal
Show decimal values in verbose (\fB\-v\fP, \fB\-vv\fP) mode.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-dump \fIFILE\fP
Dump a Z80 snapshot to this file after execution.
.UNINDENT
.INDENT 0.0
.TP
.B \-i\fP,\fB  \-\-interrupts
Execute interrupt routines.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-max\-operations \fIMAX\fP
Maximum number of instructions to execute. Overrides the \fISTOP\fP address (if
given).
.TP
.B \-\-max\-tstates \fIMAX\fP
Maximum number of (simulated) T\-states to run for. Overrides the \fISTOP\fP
address (if given).
.TP
.B \-o, \-\-org \fIORG\fP
Specify the origin address of a binary (raw memory) file. The default origin
address is 65536 minus the length of the file. \fIORG\fP must be a decimal
number, or a hexadecimal number prefixed by \(aq0x\(aq.
.TP
.B \-p, \-\-poke \fIa[\-b[\-c]],[^+]v\fP
POKE N,v for N in {a, a+c, a+2c..., b}. Prefix \(aqv\(aq with \(aq^\(aq to perform an
XOR operation, or \(aq+\(aq to perform an ADD operation. This option may be used
multiple times. \(aqa\(aq, \(aqb\(aq, \(aqc\(aq and \(aqv\(aq must each be a decimal number, or a
hexadecimal number prefixed by \(aq0x\(aq.
.TP
.B \-r, \-\-reg \fIname=value\fP
Set the value of a register before execution begins. Do \fB\-\-reg help\fP for
more information, or see the section on \fBREGISTERS\fP below. This option may
be used multiple times.
.TP
.B \-\-rom \fIFILE\fP
Patch in a ROM at address 0 from this file. By default the 48K ZX Spectrum
ROM is used.
.TP
.B \-s, \-\-start \fIADDR\fP
Start execution at this address. \fIADDR\fP must be a decimal number, or a
hexadecimal number prefixed by \(aq0x\(aq. If this option is omitted, execution
starts either at the address given by the value of the program counter (for a
SNA, SZX or Z80 snapshot), or at the origin address of the raw memory file.
.TP
.B \-S, \-\-stop \fIADDR\fP
Stop execution at this address. \fIADDR\fP must be a decimal number, or a
hexadecimal number prefixed by \(aq0x\(aq.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-stats
Show statistics after execution.
.TP
.B \-v\fP,\fB  \-\-verbose
Show executed instructions. Repeat this option (\fB\-vv\fP) to show register
values too.
.TP
.B \-V\fP,\fB  \-\-version
Show SkoolKit version number and exit.
.UNINDENT
.SH REGISTERS
.sp
The \fB\-\-reg\fP option sets the value of a register before execution begins.
.nf

.in +2
\fB\-\-reg name=value\fP
.in -2
.fi
.sp
.sp
For example:
.nf

.in +2
\fB\-\-reg hl=32768\fP
\fB\-\-reg b=0x1f\fP
.in -2
.fi
.sp
.sp
To set the value of an alternate (shadow) register, use the \(aq^\(aq prefix:
.nf

.in +2
\fB\-\-reg ^hl=10072\fP
.in -2
.fi
.sp
.sp
Recognised register names are:
.nf

.in +2
\fB^a\fP, \fB^b\fP, \fB^bc\fP, \fB^c\fP, \fB^d\fP, \fB^de\fP, \fB^e\fP, \fB^f\fP, \fB^h\fP, \fB^hl\fP, \fB^l\fP,
\fBa\fP, \fBb\fP, \fBbc\fP, \fBc\fP, \fBd\fP, \fBde\fP, \fBe\fP, \fBf\fP, \fBh\fP, \fBhl\fP, \fBl\fP,
\fBi\fP, \fBix\fP, \fBiy\fP, \fBpc\fP, \fBr\fP, \fBsp\fP
.in -2
.fi
.sp
.SH EXAMPLES
.INDENT 0.0
.IP 1. 3
Execute and show instructions in the routine at 32768\-32798 in \fBgame.z80\fP:
.UNINDENT
.nf

.in +2
\fBtrace.py \-v \-s 32768 \-S 32798 game.z80\fP
.in -2
.fi
.sp
.INDENT 0.0
.IP 2. 3
Show delays between changes in the state of the ZX Spectrum speaker produced
by the sound effect routine at 49152\-49193 in \fBgame.z80\fP:
.UNINDENT
.nf

.in +2
\fBtrace.py \-\-audio \-s 49152 \-S 49193 game.z80\fP
.in -2
.fi
.sp
.SH AUTHOR
Richard Dymond
.SH COPYRIGHT
2023, Richard Dymond
.\" Generated by docutils manpage writer.
.
