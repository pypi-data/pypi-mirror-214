"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationAuthTokens_index_tsx"],{"./app/views/settings/organizationAuthTokens/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{OrganizationAuthTokensIndex:()=>F,default:()=>B,tokenPreview:()=>X});var a=n("../node_modules/react/index.js"),s=n("./app/actionCreators/indicator.tsx"),o=n("./app/components/acl/access.tsx"),i=n("./app/components/alert.tsx"),r=n("./app/components/button.tsx"),d=n("./app/components/emptyMessage.tsx"),c=n("./app/components/links/externalLink.tsx"),l=n("./app/components/loadingError.tsx"),p=n("./app/components/loadingIndicator.tsx"),u=n("./app/components/panels/index.tsx"),m=n("./app/components/sentryDocumentTitle.tsx"),h=n("./app/locale.tsx"),g=n("./app/utils/dates.tsx"),k=n("./app/utils/handleXhrErrorResponse.tsx"),Z=n("./app/utils/withOrganization.tsx"),x=n("./app/views/settings/components/settingsPageHeader.tsx"),y=n("./app/views/settings/components/text/textBlock.tsx"),w=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),f=n("./app/components/confirm.tsx"),v=n("./app/components/links/link.tsx"),z=n("./app/components/timeSince.tsx"),j=n("./app/components/tooltip.tsx"),L=n("./app/icons/index.tsx"),T=n("./app/styles/space.tsx"),b=n("./app/utils/getDynamicText.tsx"),C=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function U(e){let{organization:t,dateLastUsed:n,projectLastUsed:s}=e;return n&&s?(0,C.tZ)(a.Fragment,{children:(0,h._N)("Last used [date] in [project]",{date:(0,C.tZ)(z.Z,{date:(0,b.Z)({value:n,fixed:new Date(150820808e4)})}),project:(0,C.tZ)(v.Z,{to:`/settings/${t.slug}/${s.slug}/`,children:s.name})})}):n?(0,C.tZ)(a.Fragment,{children:(0,h._N)("Last used [date]",{date:(0,C.tZ)(z.Z,{date:(0,b.Z)({value:n,fixed:new Date(150820808e4)})})})}):s?(0,C.tZ)(a.Fragment,{children:(0,h._N)("Last used in [project]",{project:(0,C.tZ)(v.Z,{to:`/settings/${t.slug}/${s.slug}/`,children:s.name})})}):(0,C.tZ)(a.Fragment,{children:(0,h.t)("Never used")})}function A(e){let{organization:t,isRevoking:n,token:a,revokeToken:s,canRevoke:o}=e;return(0,C.BX)(D,{children:[(0,C.BX)(_,{children:[(0,C.tZ)(I,{children:(0,C.tZ)(v.Z,{to:`/settings/${t.slug}/auth-tokens/${a.id}/`,children:a.name})}),(0,C.tZ)(N,{children:(0,C.tZ)(j.u,{title:(0,h.t)("You must be an organization owner, manager or admin to revoke a token."),disabled:o,children:(0,C.tZ)(f.Z,{disabled:!o||n,onConfirm:()=>s(a),message:(0,h.t)("Are you sure you want to revoke this token? The token will not be usable anymore, and this cannot be undone."),children:(0,C.tZ)(r.zx,{size:"sm",onClick:()=>s(a),disabled:n||!o,icon:n?(0,C.tZ)(p.Z,{mini:!0}):(0,C.tZ)(L.JZ,{isCircled:!0,size:"xs"}),children:(0,h.t)("Revoke")})})})})]}),(0,C.BX)(R,{children:[a.tokenLastCharacters&&(0,C.tZ)(S,{children:X((0,b.Z)({value:a.tokenLastCharacters,fixed:"ABCD"}))}),(0,C.tZ)(P,{children:(0,C.tZ)(U,{dateLastUsed:a.dateLastUsed,projectLastUsed:a.projectLastUsed,organization:t})})]})]})}U.displayName="LastUsed",A.displayName="OrganizationAuthTokensAuthTokenRow";const D=(0,w.Z)(u.Lv,{target:"ejq8tdr6"})("flex-direction:column;padding:",(0,T.D)(2),";gap:",(0,T.D)(1),";"),_=(0,w.Z)("div",{target:"ejq8tdr5"})("display:flex;flex-wrap:wrap;align-items:center;gap:",(0,T.D)(.25)," ",(0,T.D)(1),";"),I=(0,w.Z)("div",{target:"ejq8tdr4"})(""),N=(0,w.Z)("div",{target:"ejq8tdr3"})({name:"1o3nkn",styles:"margin-left:auto"}),R=(0,w.Z)("div",{target:"ejq8tdr2"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),P=(0,w.Z)("div",{target:"ejq8tdr1"})("font-size:",(e=>e.theme.fontSizeRelativeSmall),";margin-left:auto;"),S=(0,w.Z)("div",{target:"ejq8tdr0"})("font-size:",(e=>e.theme.fontSizeRelativeSmall),";");function q(e){let{name:t,scopes:n,dateCreated:a=new Date,dateLastUsed:s,projectLastUsed:o}=e;return{id:crypto.randomUUID(),name:t,tokenLastCharacters:crypto.randomUUID().slice(0,4),scopes:n,dateCreated:a,dateLastUsed:s,projectLastUsed:o}}function F(e){let{organization:t}=e;const[n,Z]=(0,a.useState)(null),[w,f]=(0,a.useState)(!1),[v,z]=(0,a.useState)(!1),j=(0,a.useCallback)((async()=>{try{await new Promise((e=>setTimeout(e,500))),Z([q({name:"custom token",scopes:["org:ci"],dateLastUsed:(0,g.qE)(new Date,"00:05:00"),projectLastUsed:{slug:"my-project",name:"My Project"},dateCreated:(0,g.qE)(new Date,"00:01:00")}),q({name:"my-project CI token",scopes:["org:ci"],dateLastUsed:new Date("2023-06-09")}),q({name:"my-pro2 CI token",scopes:["org:ci"]})]),f(!1)}catch(e){const t=(0,h.t)("Failed to load auth tokens for the organization.");(0,k.X)(t,e),f(e)}}),[]),L=(0,a.useCallback)((async e=>{try{z(!0),await new Promise((e=>setTimeout(e,500)));const t=(n||[]).filter((t=>t!==e));Z(t),(0,s.S9)((0,h.t)("Revoked auth token for the organization."))}catch(e){const t=(0,h.t)("Failed to revoke the auth token for the organization.");(0,k.X)(t,e),(0,s.Iw)(t)}finally{z(!1)}}),[n]),T=(0,C.tZ)(r.zx,{priority:"primary",size:"sm",to:`/settings/${t.slug}/auth-tokens/new-token/`,"data-test-id":"create-token",children:(0,h.t)("Create New Token")});return(0,a.useEffect)((()=>{j()}),[j]),(0,C.tZ)(o.Z,{access:["org:write"],children:e=>{let{hasAccess:s}=e;return(0,C.BX)(a.Fragment,{children:[(0,C.tZ)(m.Z,{title:(0,h.t)("Auth Tokens")}),(0,C.tZ)(x.Z,{title:(0,h.t)("Auth Tokens"),action:T}),(0,C.tZ)(i.ZP,{children:"Note: This page is WIP and currently only shows mocked data."}),(0,C.tZ)(y.Z,{children:(0,h.t)("Authentication tokens allow you to perform actions against the Sentry API on behalf of your organization. They're the easiest way to get started using the API.")}),(0,C.tZ)(y.Z,{children:(0,h._N)("For more information on how to use the web API, see our [link:documentation].",{link:(0,C.tZ)(c.Z,{href:"https://docs.sentry.io/api/"})})}),(0,C.BX)(u.s_,{children:[(0,C.tZ)(u.V9,{children:(0,h.t)("Auth Token")}),(0,C.BX)(u.N,{children:[w&&(0,C.tZ)(l.Z,{message:(0,h.t)("Failed to load auth tokens for the organization."),onRetry:j}),!w&&!n&&(0,C.tZ)(p.Z,{}),!w&&n&&0===n.length&&(0,C.tZ)(d.Z,{children:(0,h.t)("You haven't created any authentication tokens yet.")}),!w&&n&&n.length>0&&n.map((e=>(0,C.tZ)(A,{organization:t,token:e,isRevoking:v,revokeToken:s?L:()=>{},canRevoke:s},e.id)))]})]})]})}})}function X(e){return`sntrys_************${e}`}F.displayName="OrganizationAuthTokensIndex";const B=(0,Z.Z)(F)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationAuthTokens_index_tsx.28ea4e003eb0aff23a94ea50d100eedd.js.map