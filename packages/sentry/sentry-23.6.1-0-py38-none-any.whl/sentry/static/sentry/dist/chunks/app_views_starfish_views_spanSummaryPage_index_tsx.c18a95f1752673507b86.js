"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_starfish_views_spanSummaryPage_index_tsx"],{"./app/utils/discover/discoverQuery.tsx":(e,t,n)=>{n.d(t,{Z:()=>l,_:()=>o});var s=n("./app/utils/discover/genericDiscoverQuery.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function i(e){return(0,a.tZ)(s.ZP,{route:"events",shouldRefetchData:r,afterFetch:(e,t)=>{const{fields:n,...s}=e.meta??{};return{...e,meta:{...n,...s}}},...e})}function o(e){const t=(0,s.JC)({route:"events",shouldRefetchData:r,afterFetch:(e,t)=>{const{fields:n,...s}=e.meta??{};return{...e,meta:{...n,...s}}},...e}),n=t.response?.getResponseHeader("Link")??void 0;return{...t,pageLinks:n}}i.displayName="DiscoverQuery";const l=i},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,n)=>{n.d(t,{AA:()=>x,JC:()=>w,ZP:()=>b,o:()=>m});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=(n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/react/index.js")),r=n("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),i=n("./app/api.tsx"),o=n("./app/locale.tsx"),l=n("./app/utils/discover/eventView.tsx"),p=n("./app/utils/performance/contexts/performanceEventViewContext.tsx"),d=n("./app/utils/useApi.tsx"),c=n("./app/utils/useOrganization.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class m{constructor(e,t){(0,s.Z)(this,"message",void 0),(0,s.Z)(this,"originalError",void 0),this.message=e,this.originalError=t}getOriginalError(){return this.originalError}}class h extends a.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null,api:new i.KU}),(0,s.Z)(this,"_shouldRefetchData",(e=>{const t=Z(this.props),n=Z(e);return!(0,l.ze)(t,n)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,s.Z)(this,"_parseError",(e=>{if(this.props.parseError)return this.props.parseError(e);if(!e)return null;const t=e.responseJSON?.detail;if("string"==typeof t)return new m(t,e);const n=t?.message;return new m("string"==typeof n?n:(0,o.t)("An unknown error occurred."),e)})),(0,s.Z)(this,"fetchData",(async()=>{const{queryBatching:e,beforeFetch:t,afterFetch:n,didFetch:s,eventView:a,orgSlug:r,route:i,setError:o}=this.props,{api:l}=this.state;if(!a.isValid())return;const p=`/organizations/${r}/${i}/`,d=Symbol("tableFetchID"),c=Z(this.props);this.setState({isLoading:!0,tableFetchID:d}),o?.(void 0),t?.(l),l.clear();try{const[t,,a]=await x(l,p,c,{queryBatching:e});if(this.state.tableFetchID!==d)return;const r=n?n(t,this.props):t;s?.(r),this.setState((e=>({isLoading:!1,tableFetchID:void 0,error:null,pageLinks:a?.getResponseHeader("Link")??e.pageLinks,tableData:r})))}catch(e){const t=this._parseError(e);this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),o&&o(t??void 0)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),n=!1===e.eventView.isValid()&&this.props.eventView.isValid(),s=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||n||s)&&this.fetchData()}render(){const{isLoading:e,error:t,tableData:n,pageLinks:s}=this.state,a={isLoading:e,error:t,tableData:n,pageLinks:s},r=this.props.children;return r?.(a)}}function g(e){const t=(0,c.Z)({allowNull:!0})?.slug,n=(0,a.useContext)(p.uL)?.eventView,s=e.orgSlug??t,r=e.eventView??n;if(void 0===s||void 0===r)throw new Error("GenericDiscoverQuery requires both an orgSlug and eventView");const i={...e,orgSlug:s,eventView:r};return(0,u.tZ)(h,{...i})}h.displayName="_GenericDiscoverQuery",g.displayName="GenericDiscoverQuery";const f=200,v=2,y=e=>new Promise((t=>setTimeout(t,e)));async function x(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{queryBatching:a,retry:r}=s;if(a?.batchRequest)return a.batchRequest(e,t,{query:n,includeAllArgs:!0});const i=r?.baseTimeout??f,o=r?.timeoutMultiplier??v,l=r?.statusCodes??[],p=r?.tries??1;let d,c=0,u=0;for(;c<p&&(!d||l.includes(d.status));){u>0&&await y(u);try{return c++,await e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...n}})}catch(e){d=e,u=i*o**(c-1)}}throw d}function Z(e){const{cursor:t,limit:n,noPagination:s,referrer:a,getRequestPayload:r,eventView:i,location:o,forceAppendRawQueryString:l}=e,p=r?r(e):i.getEventsAPIPayload(o,l);return t&&(p.cursor=t),n&&(p.per_page=n),s&&(p.noPagination=s),a&&(p.referrer=a),Object.assign(p,e.queryExtras??{}),p}function w(e){const t=(0,d.Z)(),{orgSlug:n,route:s,options:a}=e,i=`/organizations/${n}/${s}/`,o=Z(e),l=(0,r.a)([s,o],(()=>x(t,i,o,{queryBatching:e.queryBatching})),a);return{...l,data:l.data?.[0]??void 0,statusCode:l.data?.[1]??void 0,response:l.data?.[2]??void 0}}const b=g},"./app/utils/performance/contexts/pageError.tsx":(e,t,n)=>{n.d(t,{De:()=>p,V_:()=>o,YY:()=>l});var s=n("../node_modules/react/index.js"),a=n("./app/components/alert.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=(0,s.createContext)({pageError:void 0,setPageError:e=>{}});function o(e){let{children:t}=e;const[n,a]=(0,s.useState)();return(0,r.tZ)(i.Provider,{value:{pageError:n,setPageError:a},children:t})}function l(){const{pageError:e}=(0,s.useContext)(i);return e?(0,r.tZ)(a.bZ,{type:"error","data-test-id":"page-error-alert",showIcon:!0,children:e}):null}o.displayName="PageErrorProvider",l.displayName="PageErrorAlert";const p=()=>(0,s.useContext)(i)},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,n)=>{n.d(t,{bq:()=>a,uL:()=>i});var s=n("./app/utils/performance/contexts/utils.tsx");const[a,r,i]=(0,s.n)({name:"PerformanceEventViewContext"})},"./app/utils/performance/contexts/utils.tsx":(e,t,n)=>{n.d(t,{n:()=>a}),n("../node_modules/core-js/modules/es.error.cause.js");var s=n("../node_modules/react/index.js");function a(e){const{strict:t=!0,errorMessage:n=`useContext for "${e.name}" must be inside a Provider with a value`,name:a}=e,r=(0,s.createContext)(void 0);return r.displayName=a,[r.Provider,function(){const e=(0,s.useContext)(r);if(!e&&t)throw new Error(n);return e},r]}},"./app/utils/useKeyPress.tsx":(e,t,n)=>{n.d(t,{Z:()=>a});var s=n("../node_modules/react/index.js");const a=(e,t)=>{const[n,a]=(0,s.useState)(!1),r=t??document.body;return(0,s.useEffect)((()=>{const t=t=>{let{key:n}=t;n===e&&a(!0)},n=t=>{let{key:n}=t;n===e&&a(!1)};return r.addEventListener("keydown",t),r.addEventListener("keyup",n),()=>{r.removeEventListener("keydown",t),r.removeEventListener("keyup",n)}}),[e,r]),n}},"./app/utils/useOnClickOutside.tsx":(e,t,n)=>{n.d(t,{Z:()=>a});var s=n("../node_modules/react/index.js");const a=function(e,t){(0,s.useEffect)((()=>{const n=n=>{const s=e?.current;s&&!s.contains(n.target)&&t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}},"./app/views/starfish/colours.tsx":(e,t,n)=>{n.d(t,{SQ:()=>a,Tn:()=>r,eO:()=>i});var s=n("./app/constants/chartPalette.tsx");const a=s.$[0][0],r=(s.$[3][1],s.$[3][3]),i=s.$[5][3]},"./app/views/starfish/components/chartPanel.tsx":(e,t,n)=>{n.d(t,{Z:()=>o});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(n("../node_modules/react/index.js"),n("./app/components/panels/index.tsx")),r=n("./app/styles/space.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{title:t,children:n,button:s}=e;return(0,i.tZ)(a.s_,{children:(0,i.BX)(a.N,{withPadding:!0,children:[t&&(0,i.BX)(p,{children:[t&&(0,i.tZ)(l,{children:t}),s]}),n]})})}o.displayName="ChartPanel";const l=(0,s.Z)("p",{target:"e1tvnfsq1"})((e=>e.theme.text.cardTitle),";"),p=(0,s.Z)("div",{target:"e1tvnfsq0"})("padding:0 ",(0,r.D)(1)," 0 0;min-height:36px;width:100%;display:flex;align-items:center;justify-content:space-between;")},"./app/views/starfish/components/detailPanel.tsx":(e,t,n)=>{n.d(t,{Z:()=>y});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("../node_modules/react/index.js"),r=n("./app/components/button.tsx"),i=n("./app/icons/iconClose.tsx"),o=n("./app/locale.tsx"),l=n("./app/styles/space.tsx"),p=n("./app/utils/useKeyPress.tsx"),d=n("./app/utils/useOnClickOutside.tsx"),c=n("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),u=n("../node_modules/framer-motion/dist/es/render/dom/motion.mjs"),m=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h="50vw",g=(0,a.forwardRef)(f);function f(e,t){let{collapsed:n,children:s}=e;return(0,m.tZ)(v,{ref:t,collapsed:n,initial:{opacity:0,x:h},animate:n?{opacity:0,x:h}:{opacity:1,x:0},transition:{type:"spring",stiffness:500,damping:50},children:s})}f.displayName="SlideOverPanel";const v=(0,s.Z)(u.E.div,{shouldForwardProp:e=>["animate","transition","initial"].includes(e)||"collapsed"!==e&&(0,c.Z)(e),target:"e1iwvxg00"})("width:",h,";position:fixed;top:0;bottom:0;right:0;background:",(e=>e.theme.background),";color:",(e=>e.theme.textColor),";border-left:1px solid ",(e=>e.theme.border),";text-align:left;z-index:",(e=>e.theme.zIndex.sidebar-1),";",(e=>e.collapsed?"overflow: hidden;":"overflow-x: hidden;\n  overflow-y: scroll;"),";");function y(e){let{children:t,detailKey:n,onClose:s}=e;const[r,l]=(0,a.useState)({collapsed:!0}),c=(0,p.Z)("Escape");(0,a.useEffect)((()=>{n&&l({collapsed:!1})}),[n]);const u=(0,a.useRef)(null);return(0,d.Z)(u,(()=>{r.collapsed||(s?.(),l({collapsed:!0}))})),(0,a.useEffect)((()=>{c&&(r.collapsed||(s?.(),l({collapsed:!0})))}),[c]),(0,m.BX)(g,{collapsed:r.collapsed,ref:u,children:[(0,m.tZ)(Z,{children:(0,m.tZ)(x,{priority:"link",size:"zero",borderless:!0,"aria-label":(0,o.t)("Close Details"),icon:(0,m.tZ)(i.b,{size:"sm"}),onClick:()=>{l({collapsed:!0}),s?.()}})}),(0,m.tZ)(w,{children:t})]})}y.displayName="Detail";const x=(0,s.Z)(r.zx,{target:"e1clb2dw2"})("color:",(e=>e.theme.gray300),";&:hover{color:",(e=>e.theme.gray400),";}"),Z=(0,s.Z)("div",{target:"e1clb2dw1"})("justify-content:flex-end;display:flex;padding:",(0,l.D)(2),";"),w=(0,s.Z)("div",{target:"e1clb2dw0"})("padding:0 ",(0,l.D)(4),";")},"./app/views/starfish/components/samplesTable/common.tsx":(e,t,n)=>{n.d(t,{W4:()=>l,fd:()=>i});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("./app/locale.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{duration:t,p95:n}=e;const s=t-n;if(Math.floor(t)===Math.floor(n))return(0,r.tZ)(o,{children:(0,a.t)("At baseline")});const i=s>0?`+${s.toFixed(2)}ms above`:`${s.toFixed(2)}ms below`;return(0,r.tZ)(l,{value:s,children:i})}i.displayName="DurationComparisonCell";const o=(0,s.Z)("div",{target:"e1tr2orr1"})(""),l=(0,s.Z)("span",{target:"e1tr2orr0"})("color:",(e=>e.value<0?e.theme.green400:e.theme.red400),";")},"./app/views/starfish/components/tableCells/durationCell.tsx":(e,t,n)=>{n.d(t,{Z:()=>p});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("./app/components/duration.tsx"),r=n("./app/styles/space.tsx"),i=n("./app/utils/formatters.tsx"),o=n("./app/views/starfish/components/samplesTable/common.tsx"),l=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{milliseconds:t,delta:n}=e;return(0,l.BX)(d,{children:[(0,l.tZ)(a.Z,{seconds:t/1e3,fixedDigits:2,abbreviation:!0}),n?(0,l.BX)(o.W4,{value:n,children:[n>0?"+":"",(0,i.rl)(n)]}):null]})}p.displayName="DurationCell";const d=(0,s.Z)("div",{target:"e1y9asl90"})("display:flex;width:100%;justify-content:space-between;gap:",(0,r.D)(1),";")},"./app/views/starfish/components/tableCells/throughputCell.tsx":(e,t,n)=>{n.d(t,{Z:()=>p});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("./app/locale.tsx"),r=n("./app/styles/space.tsx"),i=n("./app/utils/formatters.tsx"),o=n("./app/views/starfish/components/samplesTable/common.tsx"),l=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{throughputPerSecond:t,delta:n}=e;const s=t?t.toFixed(2):"--";return(0,l.BX)(d,{children:[(0,l.tZ)("span",{children:`${(0,i.Du)(s)}/${(0,a.t)("s")}`}),n?(0,l.BX)(o.W4,{value:-1*n,children:[n>0?"+":"",(0,i.rl)(n)]}):null]})}p.displayName="ThroughputCell";const d=(0,s.Z)("div",{target:"e1cpe2330"})("display:flex;width:100%;justify-content:space-between;gap:",(0,r.D)(1),";")},"./app/views/starfish/components/tableCells/timeSpentCell.tsx":(e,t,n)=>{n.d(t,{z:()=>o});var s=n("./app/components/tooltip.tsx"),a=n("./app/utils/formatters.tsx"),r=n("./app/views/starfish/views/spans/types.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{timeSpentPercentage:t,totalSpanTime:n}=e;const o=(0,r.g)("timeSpent",n),l=t>1?1:t;return(0,i.tZ)("span",{children:(0,i.tZ)(s.u,{isHoverable:!0,title:o,children:(0,a.rl)(l)})})}o.displayName="TimeSpentCell"},"./app/views/starfish/components/textAlign.tsx":(e,t,n)=>{n.d(t,{Dq:()=>a,_F:()=>i,xe:()=>r});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");const a=(0,s.Z)("span",{target:"e16p96xr2"})({name:"evqzij",styles:"text-align:right;width:100%"}),r=(0,s.Z)("span",{target:"e16p96xr1"})({name:"zq26zb",styles:"text-align:left;width:100%"}),i=(0,s.Z)("span",{target:"e16p96xr0"})({name:"12wal98",styles:"text-overflow:ellipsis;overflow:hidden;white-space:nowrap"})},"./app/views/starfish/utils/chartValueFormatters/formatThroughput.ts":(e,t,n)=>{n.d(t,{Z:()=>a});var s=n("./app/locale.tsx");const a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return`${-1===e?"--":e.toFixed(2)} / ${(0,s.t)("s")}`}},"./app/views/starfish/utils/useSpansQuery.tsx":(e,t,n)=>{n.d(t,{bB:()=>c}),n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/core-js/modules/es.array.push.js");var s=n("../node_modules/moment/moment.js"),a=n.n(s),r=n("./app/utils/discover/discoverQuery.tsx"),i=n("./app/utils/discover/eventView.tsx"),o=n("./app/utils/discover/genericDiscoverQuery.tsx"),l=n("./app/utils/useLocation.tsx"),p=n("./app/utils/useOrganization.tsx");const d="YYYY-MM-DDTHH:mm:ss";function c(e){let{eventView:t,initialData:n,limit:s,enabled:a,referrer:r="use-spans-query",cursor:i}=e;const o=function(e){let{isTimeseriesQuery:t}=e;return t?u:m}({isTimeseriesQuery:(t?.yAxis?.length??0)>0});if(t)return o({eventView:t,initialData:n,limit:s,enabled:a,referrer:r,cursor:i});throw new Error("eventView argument must be defined when Starfish useDiscover is true")}function u(e){let{eventView:t,enabled:n,initialData:s,referrer:a,cursor:r}=e;const d=(0,l.T)(),c=(0,p.Z)(),{isLoading:u,data:m}=(0,o.JC)({route:"events-stats",eventView:t,location:d,orgSlug:c.slug,getRequestPayload:()=>({...t.getEventsAPIPayload(d),yAxis:t.yAxis,topEvents:t.topEvents,excludeOther:0,partial:1,orderby:t.sorts?.[0]?(0,i.uZ)(t.sorts?.[0]):void 0,interval:t.interval,cursor:r}),options:{enabled:n,refetchOnWindowFocus:!1},referrer:a});return{isLoading:u,data:u&&s?s:h(m,t)}}function m(e){let{eventView:t,initialData:n,enabled:s,referrer:a,limit:i,cursor:o}=e;const d=(0,l.T)(),c=(0,p.Z)(),{isLoading:u,data:m,pageLinks:h}=(0,r._)({eventView:t,orgSlug:c.slug,location:d,referrer:a,cursor:o,limit:i,options:{enabled:s,refetchOnWindowFocus:!1}});return{isLoading:u,data:u&&n?n:m?.data,pageLinks:h}}function h(e,t){if(!t.yAxis)return[];let n=[];const s=t.yAxis&&("string"==typeof t.yAxis||1===t.yAxis.length),r="string"==typeof t.yAxis?t.yAxis:t.yAxis[0];return e.data?g(e,s?r:"count"):(Object.keys(e).forEach((t=>{e[t].data?n=f(n,g(e[t],s?r:t)):Object.keys(e[t]).forEach((s=>{"order"!==s&&(n=f(n,g(e[t][s],s,t)))}))})),n.map((e=>({...e,interval:a()(1e3*parseInt(e.interval,10)).format(d)}))))}function g(e,t,n){const s=[];return e.data.forEach((e=>{let[a,[{count:r}]]=e;const i=s.find((e=>e.interval===a&&(!n||e.group===n)));i?i[t]=r:s.push({interval:a,[t]:r,group:n})})),s}function f(e,t){const n=JSON.parse(JSON.stringify(e));return t.forEach((e=>{let{interval:t,group:s,...a}=e;const r=n.find((e=>e.interval===t&&(!s||e.group===s)));r?Object.keys(a).forEach((e=>{r[e]=a[e]})):n.push({interval:t,group:s,...a})})),n}},"./app/views/starfish/views/spanSummaryPage/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{Block:()=>$e,BlockContainer:()=>qe,default:()=>ze});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("../node_modules/lodash/omit.js"),r=n.n(a),i=n("./app/components/button.tsx"),o=n("./app/components/datePageFilter.tsx"),l=n("./app/components/layouts/thirds.tsx"),p=n("./app/components/organizations/pageFilters/container.tsx"),d=n("./app/components/panels/index.tsx"),c=n("./app/components/questionTooltip.tsx"),u=n("./app/locale.tsx"),m=n("./app/styles/space.tsx"),h=n("./app/utils/performance/contexts/pageError.tsx"),g=n("./app/views/starfish/colours.tsx"),f=n("./app/views/starfish/components/chart.tsx"),v=n("./app/views/starfish/components/chartPanel.tsx");const y=(0,s.Z)("div",{target:"e1enucjs0"})("padding:",(0,m.D)(1),";border-radius:",(e=>e.theme.borderRadius),";overflow-x:auto;white-space:pre-wrap;");var x=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Z=(e,t)=>{let n="";return e.split("").map(((s,a)=>{n+=s;let r=null;if(n===t.action?r=(0,x.BX)(b,{children:[t.action," "]},a):n===t.domain?r=(0,x.BX)(_,{children:[t.domain," "]},a):w.has(n)?r=(0,x.tZ)(E,{children:n},a):["(",")"].includes(n)?r=(0,x.tZ)(j,{children:n},a):" "===s||"\n"===s||")"===e[a+1]?r=n:"%s"===n?r=(0,x.tZ)(S,{children:n}):a===e.length-1&&(r=n),r){n="";const e=r;return r=null,e}return null}))},w=new Set(["ADD","ALL","ALTER","COLUMN","TABLE","AND","ANY","AS","ASC","BACKUP","DATABASE","BETWEEN","CASE","CHECK","CONSTRAINT","CREATE","DATABASE","DEFAULT","DELETE","DESC","DISTINCT","DROP","EXEC","EXISTS","FOREIGN","KEY","FROM","FULL","OUTER","INNER","LEFT","RIGHT","ORDER","ON","LIMIT","WHERE","COUNT","JOIN","GROUP","BY","HAVING","UPDATE"]),b=(0,s.Z)("b",{target:"e1sm9bxn4"})("color:",(e=>e.theme.blue400),";"),_=(0,s.Z)("b",{target:"e1sm9bxn3"})("color:",(e=>e.theme.green400),";margin-right:-",(0,m.D)(.5),";"),S=(0,s.Z)("b",{target:"e1sm9bxn2"})("color:",(e=>e.theme.red400),";margin-right:-",(0,m.D)(.5),";"),E=(0,s.Z)("b",{target:"e1sm9bxn1"})("color:",(e=>e.theme.yellow400),";"),j=(0,s.Z)("b",{target:"e1sm9bxn0"})("color:",(e=>e.theme.pink400),";");function D(e){let{spanMeta:t}=e;return t["span.op"].startsWith("db")?(0,x.tZ)(T,{spanMeta:t}):(0,x.tZ)("div",{children:t["span.description"]})}function T(e){let{spanMeta:t}=e;return(0,x.tZ)(N,{children:(0,x.tZ)(y,{children:Z(t["span.description"]||"",{action:t["span.action"]||"",domain:t["span.domain"]||""})})})}D.displayName="SpanDescription",T.displayName="DatabaseSpanDescription";const N=(0,s.Z)("div",{target:"elfaq7i0"})("font-size:",(e=>e.theme.fontSizeMedium),";");var L=n("./app/views/starfish/components/tableCells/durationCell.tsx"),C=n("./app/views/starfish/components/tableCells/throughputCell.tsx"),P=n("./app/views/starfish/components/tableCells/timeSpentCell.tsx"),k=n("./app/utils/discover/eventView.tsx"),A=n("./app/utils/discover/types.tsx"),F=n("./app/utils/useLocation.tsx"),$=n("./app/views/starfish/utils/useSpansQuery.tsx");function B(e,t,n){return k.ZP.fromNewQueryWithLocation({name:"",query:`span.group:${e}${n?` transaction:${n}`:""}`,fields:["span.op","span.description","span.action","span.domain","count()"],dataset:A.as.SPANS_METRICS,projects:[1],version:2},t)}n("../node_modules/core-js/modules/es.array.push.js");const I=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"span-metrics";const a=(0,F.T)();t.transactionName&&[].push(`transaction = ${t.transactionName}`);const r=e?function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const a=e.group.replaceAll("-","").slice(-16);return k.ZP.fromNewQueryWithLocation({name:"",query:`span.group:${a}${n?` transaction:${n}`:""}`,fields:s,dataset:A.as.SPANS_METRICS,projects:[1],version:2},t)}(e,a,t.transactionName,n):void 0,{isLoading:i,data:o}=(0,$.bB)({eventView:r,initialData:[],enabled:Boolean(e),referrer:s});return{isLoading:i,data:o[0]??{}}};var V=n("../node_modules/lodash/keyBy.js"),q=n.n(V),M=n("./app/components/charts/utils.tsx"),O=n("./app/utils/usePageFilters.tsx");const R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"span-metrics-series";const a=(0,F.T)(),r=(0,O.Z)(),i=e?function(e,t,n,s,a){const r=e.group.replaceAll("-","").slice(-16);return k.ZP.fromNewQueryWithLocation({name:"",query:`span.group:${r}${a?` transaction:${a}`:""}`,fields:[],yAxis:s,dataset:A.as.SPANS_METRICS,interval:(0,M.ZS)(n.datetime,"low"),projects:[1],version:2},t)}(e,a,r.selection,n,t.transactionName):void 0,{isLoading:o,data:l}=(0,$.bB)({eventView:i,initialData:[],referrer:s});return{isLoading:o,data:q()(n.map((e=>({seriesName:e,data:l.map((t=>({value:t[e],name:t.interval})))}))),"seriesName")}};var z=n("./app/views/starfish/types.tsx"),X=n("./app/views/starfish/utils/chartValueFormatters/formatThroughput.ts"),Q=n("./app/views/starfish/views/spans/types.tsx"),H=n("./app/utils/useRouter.tsx"),W=n("./app/views/starfish/components/detailPanel.tsx"),U=n("../node_modules/react/index.js"),Y=n("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),K=n("../node_modules/moment/moment.js"),G=n.n(K),J=n("./app/utils/discover/discoverQuery.tsx"),ee=n("./app/utils/useOrganization.tsx");const te=10,ne="-duration";function se(e,t,n,s){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"use-span-samples";const r=(0,F.T)(),i=(0,ee.Z)(),o=k.ZP.fromNewQueryWithLocation({name:"Span Samples",query:`${e?` group:${e}`:""} ${t?` transaction:${t}`:""}`,fields:["span_id","group","action","description","domain","module",z.N.SPAN_SELF_TIME,"op","transaction_id","timestamp"],dataset:A.as.SPANS_INDEXED,orderby:s??ne,projects:[1],version:2},r),l=(0,J._)({eventView:o,orgSlug:i.slug,location:r,referrer:a,limit:n??te}),p=l.data?.data??[],d=l.pageLinks;return{...l,data:p,pageLinks:d}}const{SPAN_SELF_TIME:ae}=z.SpanMetricsFields;function re(e){let{groupId:t,transactionName:n}=e;const s=(0,Y.u)(),{isLoading:a,data:r}=R({group:t},{transactionName:n},[`p95(${ae})`],"sidebar-span-metrics"),{data:i,isLoading:o}=se(t,n,void 0,"-duration","span-summary-panel-samples-table-spans"),l=i.map((e=>{let{timestamp:t,"span.self_time":n,transaction_id:a}=e;return{data:[{name:G()(t).unix(),value:n}],symbol:"path://M -1 -1 V -5 H 0 V -1 H 4 V 0 H 0 V 4 H -1 V 0 H -5 V -1 H -1",color:s.gray400,symbolSize:15,seriesName:a}}));return(0,x.BX)(U.Fragment,{children:[(0,x.tZ)("h5",{children:Q.F.p95}),(0,x.tZ)(f.ZP,{statsPeriod:"24h",height:140,data:[r?.[`p95(${ae})`]],start:"",end:"",loading:a,scatterPlot:o?void 0:l,utc:!1,chartColors:[g.Tn],isLineChart:!0,definedAxisTicks:4})]})}re.displayName="DurationChart";const ie=re,{SPAN_SELF_TIME:oe}=z.SpanMetricsFields;function le(e){const{groupId:t,transactionName:n}=e,{data:s}=I({group:t},{transactionName:n},["sps()",`sum(${oe})`,`p95(${oe})`,"time_spent_percentage(local)"],"span-summary-panel-metrics");return(0,x.BX)(qe,{children:[(0,x.tZ)($e,{title:Q.F.throughput,children:(0,x.tZ)(C.Z,{throughputPerSecond:s?.["sps()"]})}),(0,x.tZ)($e,{title:Q.F.p95,children:(0,x.tZ)(L.Z,{milliseconds:s?.[`p95(${oe})`]})})]})}le.displayName="SampleInfo";const pe=le;var de=n("./app/components/pagination.tsx"),ce=n("../node_modules/react-router/es/index.js"),ue=n("./app/components/dateTime.tsx"),me=n("./app/components/gridEditable/index.tsx"),he=n("./app/views/performance/transactionSummary/transactionSpans/spanDetails/spanDetailsTable.tsx"),ge=n("./app/views/starfish/components/samplesTable/common.tsx"),fe=n("./app/views/starfish/components/textAlign.tsx");const ve=[{key:"transaction_id",name:"Event ID",width:200},{key:"duration",name:"Span Duration",width:200},{key:"p95_comparison",name:"Compared to P95",width:200}];function ye(e){let{isLoading:t,data:n,p95:s}=e;const a=(0,F.T)();return(0,x.tZ)(me.ZP,{isLoading:t,data:n,columnOrder:ve,columnSortBy:[],grid:{renderHeadCell:function(e){return"p95_comparison"===e.key?(0,x.tZ)(fe.Dq,{children:(0,x.tZ)(fe._F,{children:e.name})}):(0,x.tZ)(fe._F,{children:e.name})},renderBodyCell:function(e,t){return"transaction_id"===e.key?(0,x.tZ)(ce.Link,{to:`/performance/${t.transaction["project.name"]}:${t.transaction_id}#span-${t.span_id}`,children:t.transaction_id.slice(0,8)}):"duration"===e.key?(0,x.tZ)(he.i,{spanOp:t.op,spanDuration:t["span.self_time"],transactionDuration:t.transaction["transaction.duration"]}):"p95_comparison"===e.key?(0,x.tZ)(ge.fd,{duration:t["span.self_time"],p95:s}):"timestamp"===e.key?(0,x.tZ)(ue.Z,{date:t.timestamp,year:!0,timeZone:!0,seconds:!0}):(0,x.tZ)("span",{children:t[e.key]})}},location:a})}ye.displayName="SpanSamplesTable";const{SPAN_SELF_TIME:xe}=z.SpanMetricsFields;function Ze(e){let{groupId:t,transactionName:n}=e;const{data:s}=I({group:t},{transactionName:n},[`p95(${xe})`],"span-summary-panel-samples-table-p95"),{data:a,isLoading:r,pageLinks:i}=se(t,n,void 0,"-duration","span-summary-panel-samples-table-spans"),{data:o,isLoading:l}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"use-transactions";const n=(0,F.T)(),{slug:s}=(0,ee.Z)(),a=k.ZP.fromNewQueryWithLocation({fields:["id","timestamp","project.name","transaction.duration"],name:"Transactions",projects:[1],version:2,query:`id:[${e.join(",")}]`},n),r=(0,J._)({eventView:a,location:n,orgSlug:s,referrer:t}),i=r.data?.data??[];return{...r,data:i}}(a.map((e=>e.transaction_id)),"span-summary-panel-samples-table-transactions"),p=q()(o,"id");return(0,x.BX)(U.Fragment,{children:[(0,x.tZ)(ye,{data:a.map((e=>({...e,transaction:p[e.transaction_id]}))),isLoading:r||l,p95:s?.[`p95(${xe})`]}),(0,x.tZ)(de.Z,{pageLinks:i})]})}Ze.displayName="SampleTable";const we=Ze;function be(e){let{groupId:t,transactionName:n}=e;const s=(0,H.Z)();return(0,x.BX)(W.Z,{detailKey:t,onClose:()=>{s.push({pathname:s.location.pathname,query:r()(s.location.query,"transaction")})},children:[(0,x.tZ)("h3",{children:n}),(0,x.tZ)(pe,{groupId:t,transactionName:n}),(0,x.tZ)(ie,{groupId:t,transactionName:n}),(0,x.tZ)(we,{groupId:t,transactionName:n})]})}be.displayName="SampleList";var _e=n("../node_modules/query-string/index.js"),Se=n("./app/components/links/link.tsx"),Ee=n("./app/components/truncate.tsx");const{SPAN_SELF_TIME:je}=z.SpanMetricsFields,De=function(e,t){const n=(0,F.T)(),s=e?function(e,t,n){const s=e.group.replaceAll("-","").slice(-16);return k.ZP.fromNewQueryWithLocation({name:"",query:`span.group:${s}${n.length>0?` transaction:[${n.join(",")}]`:""}`,fields:["transaction","sps()","sps_percent_change()",`sum(${je})`,`p95(${je})`,`percentile_percent_change(${je}, 0.95)`,"time_spent_percentage(local)"],orderby:"-time_spent_percentage_local",dataset:A.as.SPANS_METRICS,projects:[1],version:2},t)}(e,n,t??[]):void 0,{isLoading:a,data:r,pageLinks:i}=(0,$.bB)({eventView:s,initialData:[],enabled:Boolean(e)});return{isLoading:a,data:r,pageLinks:i}},{SPAN_SELF_TIME:Te}=z.SpanMetricsFields;function Ne(e){let{span:t,openSidebar:n,onClickTransaction:s,endpoint:a}=e;const r=(0,F.T)(),{data:i,isLoading:o,pageLinks:l}=De(t,a?[a]:void 0),p=i.map((e=>({transaction:e.transaction,metrics:e})));return(0,x.BX)(U.Fragment,{children:[(0,x.tZ)(me.ZP,{isLoading:o,data:p,columnOrder:Pe,columnSortBy:[],grid:{renderHeadCell:e=>(0,x.tZ)("span",{children:e.name}),renderBodyCell:(e,r)=>(0,x.tZ)(Le,{span:t,column:e,row:r,openSidebar:n,onClickTransactionName:s,endpoint:a})},location:r}),(0,x.tZ)(de.Z,{pageLinks:l})]})}function Le(e){let{span:t,column:n,row:s,openSidebar:a,onClickTransactionName:r,endpoint:i}=e;return"transaction"===n.key?(0,x.tZ)(Ce,{endpoint:i,span:t,row:s,column:n,openSidebar:a,onClickTransactionName:r}):"p95(transaction.duration)"===n.key?(0,x.tZ)(L.Z,{milliseconds:s.metrics?.[`p95(${Te})`],delta:s.metrics?.[`percentile_percent_change(${Te}, 0.95)`]}):"sps()"===n.key?(0,x.tZ)(C.Z,{throughputPerSecond:s.metrics?.["sps()"],delta:s.metrics?.["sps_percent_change()"]}):"time_spent_percentage(local)"===n.key?(0,x.tZ)(P.z,{timeSpentPercentage:s.metrics?.["time_spent_percentage(local)"],totalSpanTime:s.metrics?.[`sum(${Te})`]}):(0,x.tZ)("span",{children:s[n.key]})}function Ce(e){let{span:t,column:n,row:s,endpoint:a}=e;return(0,x.tZ)(U.Fragment,{children:(0,x.tZ)(Se.Z,{to:`/starfish/span/${encodeURIComponent(t.group)}?${_e.stringify({endpoint:a,transaction:s.transaction})}`,children:(0,x.tZ)(Ee.Z,{value:s[n.key],maxLength:75})})})}Ne.displayName="SpanTransactionsTable",Le.displayName="BodyCell",Ce.displayName="TransactionCell";const Pe=[{key:"transaction",name:"Found In Endpoints",width:me.z7},{key:"sps()",name:Q.F.throughput,width:175},{key:"p95(transaction.duration)",name:Q.F.p95,width:175},{key:"time_spent_percentage(local)",name:Q.F.timeSpent,width:me.z7}],{SPAN_SELF_TIME:ke}=z.SpanMetricsFields;function Ae(e){let{params:t,location:n}=e;const{groupId:s}=t,{transaction:a,endpoint:c}=n.query,m=c?{transactionName:c}:void 0,{data:y}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"span-metrics";const s=(0,F.T)();return(0,$.bB)({eventView:B(e,s,t.transactionName),initialData:[],referrer:n})}(s,m,"span-summary-page-span-meta"),Z={group:s,...y?.[0]},{data:w}=I({group:s},m,["sps()",`sum(${ke})`,`p95(${ke})`,"time_spent_percentage()"],"span-summary-page-metrics"),{isLoading:b,data:_}=R({group:s},m,[`p95(${ke})`,"sps()"],"sidebar-span-metrics");return(0,f.K4)([!b]),(0,x.tZ)(l.T3,{children:(0,x.tZ)(p.Z,{children:(0,x.BX)(h.V_,{children:[(0,x.tZ)(l.h4,{children:(0,x.tZ)(l.oB,{children:(0,x.tZ)(l.Dx,{children:(0,u.t)("Span Summary")})})}),(0,x.tZ)(l.uT,{children:(0,x.BX)(l.or,{fullWidth:!0,children:[(0,x.tZ)(h.YY,{}),(0,x.BX)(qe,{children:[(0,x.tZ)(Fe,{children:(0,x.tZ)(o.Z,{alignDropdown:"left"})}),(0,x.BX)(qe,{children:[(0,x.tZ)($e,{title:(0,u.t)("Operation"),children:Z?.["span.op"]}),(0,x.tZ)($e,{title:(0,u.t)("Throughput"),description:(0,u.t)("Throughput of this span per second"),children:(0,x.tZ)(C.Z,{throughputPerSecond:w?.["sps()"]})}),(0,x.tZ)($e,{title:(0,u.t)("Duration"),description:(0,u.t)("Time spent in this span"),children:(0,x.tZ)(L.Z,{milliseconds:w?.[`p95(${ke})`]})}),(0,x.tZ)($e,{title:(0,u.t)("Time Spent"),description:(0,u.t)("Time spent in this span as a proportion of total application time"),children:(0,x.tZ)(P.z,{timeSpentPercentage:w?.["time_spent_percentage()"],totalSpanTime:w?.[`p95(${ke})`]})})]})]}),Z?.["span.description"]&&(0,x.BX)(qe,{children:[(0,x.tZ)($e,{children:(0,x.tZ)(d.s_,{children:(0,x.tZ)(Oe,{children:(0,x.tZ)(Me,{children:(0,x.tZ)(D,{spanMeta:y?.[0]})})})})}),(0,x.tZ)($e,{children:(0,x.tZ)(v.Z,{title:Q.F.throughput,children:(0,x.tZ)(f.ZP,{statsPeriod:"24h",height:140,data:[_?.["sps()"]],start:"",end:"",loading:b,utc:!1,chartColors:[g.SQ],isLineChart:!0,definedAxisTicks:4,tooltipFormatterOptions:{valueFormatter:e=>(0,X.Z)(e)}})})}),(0,x.tZ)($e,{children:(0,x.tZ)(v.Z,{title:Q.F.p95,children:(0,x.tZ)(f.ZP,{statsPeriod:"24h",height:140,data:[_?.[`p95(${ke})`]],start:"",end:"",loading:b,utc:!1,chartColors:[g.Tn],isLineChart:!0,definedAxisTicks:4})})})]}),Z&&(0,x.tZ)(Ne,{span:Z,endpoint:c}),c&&(0,x.tZ)(i.zx,{to:{pathname:n.pathname,query:r()(n.query,"endpoint")},children:(0,u.t)("View More Endpoints")}),a&&Z?.group&&(0,x.tZ)(be,{groupId:Z.group,transactionName:a})]})})]})})})}Ae.displayName="SpanSummaryPage";const Fe=(0,s.Z)("div",{target:"eby1jon7"})("display:flex;flex-direction:row;gap:",(0,m.D)(1),";align-items:center;flex:1;");function $e(e){let{title:t,description:n,children:s}=e;return(0,x.BX)(Re,{children:[(0,x.BX)(Be,{children:[t,n&&(0,x.tZ)(Ve,{children:(0,x.tZ)(c.Z,{size:"sm",position:"right",title:n})})]}),(0,x.tZ)(Ie,{children:s})]})}$e.displayName="Block";const Be=(0,s.Z)("h3",{target:"eby1jon6"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeMedium),";margin:0;margin-bottom:",(0,m.D)(1),";white-space:nowrap;"),Ie=(0,s.Z)("h4",{target:"eby1jon5"})({name:"3in70x",styles:"margin:0;font-weight:normal"}),Ve=(0,s.Z)("span",{target:"eby1jon4"})("margin-left:",(0,m.D)(1),";"),qe=(0,s.Z)("div",{target:"eby1jon3"})("display:flex;&>div:last-child{padding-right:",(0,m.D)(1),";}padding-bottom:",(0,m.D)(2),";"),Me=(0,s.Z)("div",{target:"eby1jon2"})("width:100%;padding:",(0,m.D)(1),";font-size:1rem;line-height:1.2;"),Oe=(0,s.Z)(d.N,{target:"eby1jon1"})("padding:",(0,m.D)(2),";height:208px;"),Re=(0,s.Z)("div",{target:"eby1jon0"})("padding-right:",(0,m.D)(4),";flex:1;"),ze=Ae},"./app/views/starfish/views/spans/types.tsx":(e,t,n)=>{n.d(t,{F:()=>l,g:()=>p});var s=n("../node_modules/react/index.js"),a=n("./app/components/links/link.tsx"),r=n("./app/locale.tsx"),i=n("./app/views/starfish/components/tableCells/durationCell.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l={timeSpent:(0,r.t)("Time Spent"),p50p95:(0,r.t)("Duration (P50, P95)"),p50:(0,r.t)("Duration (P50)"),p95:(0,r.t)("Duration (P95)"),duration:(0,r.t)("Duration"),errorCount:(0,r.t)("5XX Responses"),throughput:(0,r.t)("Throughput")},p=function(e){if("timeSpent"===e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(0,o.BX)(s.Fragment,{children:[(0,o.tZ)("div",{children:(0,o.tZ)(i.Z,{milliseconds:n[0]})}),(0,o.tZ)(a.Z,{to:"/starfish/definitions/",children:"How was this calculated?"})]})}return""}}}]);
//# sourceMappingURL=../sourcemaps/app_views_starfish_views_spanSummaryPage_index_tsx.c622580f9cb4b595900f01e2dc411b73.js.map