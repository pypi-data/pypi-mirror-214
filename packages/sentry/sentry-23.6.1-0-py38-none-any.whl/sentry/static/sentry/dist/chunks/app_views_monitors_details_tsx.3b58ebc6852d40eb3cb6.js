"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_details_tsx"],{"./app/actionCreators/monitors.tsx":(t,e,n)=>{n.d(e,{Mw:()=>i,gm:()=>a,so:()=>l});var o=n("./app/actionCreators/indicator.tsx"),r=n("./app/locale.tsx"),s=n("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js");async function i(t,e,n){(0,o.E3)((0,r.t)("Deleting Monitor..."));try{await t.requestPromise(`/organizations/${e}/monitors/${n}/`,{method:"DELETE"}),(0,o.B8)()}catch{(0,o.Iw)((0,r.t)("Unable to remove monitor."))}}async function a(t,e,n,s){(0,o.E3)((0,r.t)("Deleting Environment..."));try{await t.requestPromise(`/organizations/${e}/monitors/${n}/`,{method:"DELETE",query:{environment:s}}),(0,o.B8)()}catch{(0,o.Iw)((0,r.t)("Unable to remove environment from monitor."))}}async function l(t,e,n,i){(0,o.E3)();try{const r=await t.requestPromise(`/organizations/${e}/monitors/${n}/`,{method:"PUT",data:i});return(0,o.B8)(),r}catch(t){a=t,s.$e((t=>{s.Tb(a)})),window.console&&console.error&&console.error(a),(0,o.Iw)((0,r.t)("Unable to update monitor."))}var a;return null}},"./app/components/issues/groupList.tsx":(t,e,n)=>{n.d(e,{Z:()=>P});var o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/react/index.js")),s=n("../node_modules/react-router/es/index.js"),i=n("../node_modules/lodash/isEqual.js"),a=n.n(i),l=n("../node_modules/lodash/omit.js"),d=n.n(l),c=n("../node_modules/query-string/index.js"),p=n("./app/actionCreators/members.tsx"),u=n("./app/components/emptyStateWarning.tsx"),m=n("./app/components/loadingError.tsx"),h=n("./app/components/loadingIndicator.tsx"),g=n("./app/components/pagination.tsx"),y=n("./app/components/panels/index.tsx"),Z=n("./app/components/replays/issuesReplayCountProvider.tsx"),x=n("./app/components/searchSyntax/parser.tsx"),f=n("./app/components/searchSyntax/utils.tsx"),b=n("./app/components/stream/group.tsx"),v=n("./app/locale.tsx"),k=n("./app/stores/groupStore.tsx"),w=n("./app/utils/withApi.tsx"),S=n("./app/utils/withSentryRouter.tsx"),I=n("./app/views/alerts/rules/metric/details/relatedIssuesNotAvailable.tsx"),C=n("./app/components/issues/groupListHeader.tsx"),N=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class j extends r.Component{constructor(){super(...arguments),(0,o.Z)(this,"state",{loading:!0,error:!1,errorData:null,groups:[],pageLinks:null}),(0,o.Z)(this,"listener",k.Z.listen((()=>this.onGroupChange()),void 0)),(0,o.Z)(this,"fetchData",(async()=>{k.Z.loadInitialData([]);const{api:t,orgId:e,queryParams:n}=this.props;t.clear(),this.setState({loading:!0,error:!1,errorData:null}),(0,p.MA)(t,e).then((t=>{this.setState({memberList:(0,p.M4)(t)})}));const o=this.getGroupListEndpoint(),r=(0,x.UG)((n??this.getQueryParams()).query);if(r&&(0,f.ly)({tree:r,noResultValue:!1,visitorTest:t=>{let{token:e,returnResult:n}=t;return e.type===x.WU.LOGIC_BOOLEAN?n(!0):null}}))this.setState({error:!0,errorData:{detail:I.H},loading:!1});else try{const[e,,n]=await t.requestPromise(o,{includeAllArgs:!0});k.Z.add(e),this.setState({error:!1,errorData:null,loading:!1,pageLinks:n?.getResponseHeader("Link")??null},(()=>{this.props.onFetchSuccess?.(this.state,this.handleCursorChange)}))}catch(t){this.setState({error:!0,errorData:t.responseJSON,loading:!1})}}))}componentDidMount(){this.fetchData()}shouldComponentUpdate(t,e){return!a()(this.state,e)||t.endpointPath!==this.props.endpointPath||t.query!==this.props.query||!a()(t.queryParams,this.props.queryParams)}componentDidUpdate(t){const e=["end"];t.orgId===this.props.orgId&&t.endpointPath===this.props.endpointPath&&t.query===this.props.query&&a()(d()(t.queryParams,e),d()(this.props.queryParams,e))||this.fetchData()}componentWillUnmount(){k.Z.reset(),this.listener?.()}getGroupListEndpoint(){const{orgId:t,endpointPath:e,queryParams:n}=this.props,o=e??`/organizations/${t}/issues/`,r=n??this.getQueryParams();return`${o}?${c.stringify(r)}`}getQueryParams(){const{location:t,query:e}=this.props,n=t.query;return n.limit=50,n.sort="new",n.query=e,n}handleCursorChange(t,e,n,o){const r=parseInt(n.page,10);let i=isNaN(r)?o:r+o;i<=0&&(t=void 0,i=void 0),s.browserHistory.push({pathname:e,query:{...n,cursor:t,page:i}})}onGroupChange(){const t=k.Z.getAllItems();a()(t,this.state.groups)||this.setState({groups:t})}render(){const{canSelectGroups:t,withChart:e,renderEmptyMessage:n,renderErrorMessage:o,withPagination:r,useFilteredStats:s,useTintRow:i,customStatsPeriod:a,queryParams:l,queryFilterDescription:d,narrowGroups:c,source:p}=this.props,{loading:x,error:f,errorData:k,groups:w,memberList:S,pageLinks:I}=this.state;if(x)return(0,N.tZ)(h.Z,{});if(f)return"function"==typeof o&&k?o(k,this.fetchData):(0,N.tZ)(m.Z,{onRetry:this.fetchData});if(0===w.length)return"function"==typeof n?n():(0,N.tZ)(y.s_,{children:(0,N.tZ)(y.N,{children:(0,N.tZ)(u.Z,{children:(0,N.tZ)("p",{children:(0,v.t)("There don't seem to be any events fitting the query.")})})})});const j="auto"===l?.groupStatsPeriod?l?.groupStatsPeriod:b.g;return(0,N.BX)(Z.Z,{groupIds:w.map((t=>{let{id:e}=t;return e})),children:[(0,N.BX)(y.s_,{children:[(0,N.tZ)(C.Z,{withChart:!!e,narrowGroups:c}),(0,N.tZ)(y.N,{children:w.map((n=>{let{id:o,project:r}=n;const l=S?.hasOwnProperty(r.slug)?S[r.slug]:void 0;return(0,N.tZ)(b.Z,{id:o,canSelect:t,withChart:e,memberList:l,useFilteredStats:s,useTintRow:i,customStatsPeriod:a,statsPeriod:j,queryFilterDescription:d,narrowGroups:c,source:p},o)}))})]}),r&&(0,N.tZ)(g.Z,{pageLinks:I,onCursor:this.handleCursorChange})]})}}j.displayName="GroupList",(0,o.Z)(j,"defaultProps",{canSelectGroups:!0,withChart:!0,withPagination:!0,useFilteredStats:!0,useTintRow:!0,narrowGroups:!1});const P=(0,w.Z)((0,S.Z)(j))},"./app/components/issues/groupListHeader.tsx":(t,e,n)=>{n.d(e,{Z:()=>d});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("./app/components/panels/index.tsx"),s=n("./app/locale.tsx"),i=n("./app/styles/space.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(t){let{withChart:e=!0,narrowGroups:n=!1,showLastTriggered:o=!1}=t;return(0,a.BX)(r.V9,{disablePadding:!0,children:[(0,a.tZ)(p,{children:(0,s.t)("Issue")}),e&&(0,a.tZ)(m,{narrowGroups:n,children:(0,s.t)("Graph")}),(0,a.tZ)(u,{children:(0,s.t)("events")}),(0,a.tZ)(u,{children:(0,s.t)("users")}),(0,a.tZ)(h,{narrowGroups:n,children:(0,s.t)("Assignee")}),o&&(0,a.tZ)(u,{children:(0,s.t)("Last Triggered")})]})}l.displayName="GroupListHeader";const d=l,c=(0,o.Z)("div",{target:"ev0gesp4"})("display:flex;align-self:center;margin:0 ",(0,i.D)(2),";color:",(t=>t.theme.subText),";"),p=(0,o.Z)(c,{target:"ev0gesp3"})("flex:1;width:66.66%;@media (min-width: ",(t=>t.theme.breakpoints.medium),"){width:50%;}"),u=(0,o.Z)(c,{target:"ev0gesp2"})("justify-content:flex-end;width:60px;white-space:nowrap;@media (min-width: ",(t=>t.theme.breakpoints.xlarge),"){width:80px;}"),m=(0,o.Z)(c,{target:"ev0gesp1"})("justify-content:space-between;width:160px;@media (max-width: ",(t=>t.narrowGroups?t.theme.breakpoints.xlarge:t.theme.breakpoints.large),"){display:none;}"),h=(0,o.Z)(c,{target:"ev0gesp0"})("justify-content:flex-end;width:80px;@media (max-width: ",(t=>t.narrowGroups?t.theme.breakpoints.large:t.theme.breakpoints.medium),"){display:none;}")},"./app/components/keyValueTable.tsx":(t,e,n)=>{n.d(e,{G:()=>l,v:()=>a});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("../node_modules/react/index.js"),s=n("./app/styles/space.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,o.Z)("dl",{target:"ehev67y2"})("display:grid;grid-template-columns:50% 50%;",(t=>t.noMargin?"margin-bottom: 0;":null),";");function l(t){let{keyName:e,value:n}=t;return(0,i.BX)(r.Fragment,{children:[(0,i.tZ)(c,{children:e}),(0,i.tZ)(p,{children:n})]})}l.displayName="KeyValueTableRow";const d=t=>{let{theme:e}=t;return`\nfont-size: ${e.fontSizeMedium};\npadding: ${(0,s.D)(.5)} ${(0,s.D)(1)};\nfont-weight: normal;\nline-height: inherit;\n${t=>t.theme.overflowEllipsis};\n&:nth-of-type(2n-1) {\n  background-color: ${e.backgroundSecondary};\n}\n`},c=(0,o.Z)("dt",{target:"ehev67y1"})(d,";color:",(t=>t.theme.textColor),";"),p=(0,o.Z)("dd",{target:"ehev67y0"})(d,";color:",(t=>t.theme.subText),";text-align:right;")},"./app/components/onboardingPanel.tsx":(t,e,n)=>{n.d(e,{Z:()=>p});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("./app/components/panels/index.tsx"),s=n("./app/styles/space.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(t){let{image:e,noCenter:n,children:o,...s}=t;return(0,i.tZ)(r.s_,{...s,children:(0,i.BX)(l,{children:[e?(0,i.tZ)(c,{children:e}):null,(0,i.tZ)(d,{centered:!e&&!n,children:o})]})})}a.displayName="OnboardingPanel";const l=(0,o.Z)("div",{target:"euclof22"})("padding:",(0,s.D)(3),";position:relative;@media (min-width: ",(t=>t.theme.breakpoints.small),"){display:flex;align-items:center;flex-direction:row;justify-content:center;flex-wrap:wrap;min-height:300px;max-width:1000px;margin:0 auto;}@media (min-width: ",(t=>t.theme.breakpoints.medium),"){min-height:350px;}"),d=(0,o.Z)("div",{target:"euclof21"})("min-width:0;z-index:1;",(t=>t.centered?"text-align: center;":"")," ",(t=>t.centered?"max-width: 600px;":""),"@media (min-width: ",(t=>t.theme.breakpoints.small),"){flex:2;}"),c=(0,o.Z)(d,{target:"euclof20"})("position:relative;min-height:100px;max-width:300px;min-width:150px;margin:",(0,s.D)(2)," auto;@media (min-width: ",(t=>t.theme.breakpoints.small),"){flex:1;margin:",(0,s.D)(3),";max-width:auto;}"),p=a},"./app/components/statusIndicator.tsx":(t,e,n)=>{n.d(e,{Z:()=>a});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("./app/components/tooltip.tsx"),s=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(t){let{status:e,tooltipTitle:n}=t,o="error";return"muted"===e?o="muted":"info"===e?o="info":"warning"===e?o="warning":"success"!==e&&"resolved"!==e||(o="success"),(0,s.tZ)(r.u,{title:n,skipWrapper:!0,children:(0,s.tZ)(l,{color:o})})}i.displayName="StatusIndicator";const a=i,l=(0,o.Z)("div",{target:"ecry7ku0"})("position:absolute;left:-1px;width:9px;height:15px;border-radius:0 3px 3px 0;background-color:",(t=>t.theme.alert[t.color].background),";& span{display:block;width:9px;height:15px;}")},"./app/views/alerts/rules/metric/details/relatedIssuesNotAvailable.tsx":(t,e,n)=>{n.d(e,{H:()=>d,z:()=>c});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("./app/components/acl/feature.tsx"),s=n("./app/components/alert.tsx"),i=n("./app/components/button.tsx"),a=n("./app/components/panels/index.tsx"),l=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d='Error parsing search query: Boolean statements containing "OR" or "AND" are not supported in this search';function c(t){let{buttonTo:e,buttonText:n}=t;return(0,l.tZ)(p,{type:"info",showIcon:!0,trailingItems:(0,l.tZ)(r.Z,{features:["discover-basic"],children:(0,l.tZ)(i.zx,{priority:"default",size:"xs",to:e,children:n})}),children:(0,l.tZ)("div",{"data-test-id":"loading-error-message",children:"Related Issues unavailable for this alert."})})}c.displayName="RelatedIssuesNotAvailable";const p=(0,o.Z)(s.bZ,{target:"e1qw7yyr0"})(a.s_," &{border-radius:0;border-width:1px 0;}")},"./app/views/monitors/components/cronsFeedbackButton.tsx":(t,e,n)=>{n.d(e,{Z:()=>i});var o=n("./app/components/featureFeedback/index.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(){return(0,r.tZ)(o.z,{featureName:"crons",buttonProps:{size:"sm"}})}s.displayName="CronsFeedbackButton";const i=s},"./app/views/monitors/details.tsx":(t,e,n)=>{n.r(e),n.d(e,{default:()=>Wt});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("../node_modules/react/index.js"),s=n("./app/components/datePageFilter.tsx"),i=n("./app/components/layouts/thirds.tsx"),a=n("./app/components/loadingIndicator.tsx"),l=n("./app/components/organizations/environmentPageFilter/index.tsx"),d=n("./app/components/organizations/pageFilterBar.tsx"),c=n("./app/components/sentryDocumentTitle.tsx"),p=n("./app/styles/space.tsx"),u=n("./app/utils/queryClient.tsx"),m=n("./app/utils/useOrganization.tsx"),h=n("./app/utils/usePageFilters.tsx"),g=n("./app/components/charts/styles.tsx"),y=n("./app/components/keyValueTable.tsx"),Z=n("./app/components/text.tsx"),x=n("./app/components/timeSince.tsx"),f=n("./app/components/tooltip.tsx"),b=n("./app/icons/index.tsx"),v=n("./app/locale.tsx"),k=n("./app/utils.tsx"),w=n("./app/utils/dates.tsx"),S=n("./app/utils/useCopyToClipboard.tsx"),I=n("./app/views/monitors/components/monitorForm.tsx"),C=n("./app/views/monitors/types.tsx");const N=(0,o.Z)("div",{target:"e1ym8bu50"})("display:inline-block;position:relative;border-radius:50%;height:",(t=>t.size),"px;width:",(t=>t.size),"px;",(t=>t.color?`background: ${t.color};`:`background: ${t.status===C.wo.ERROR||t.status===C.wo.TIMEOUT?t.theme.error:t.status===C.wo.OK?t.theme.success:t.status===C.wo.MISSED_CHECKIN?t.theme.warning:t.theme.disabled};`),";");var j=n("./app/views/monitors/utils.tsx"),P=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function _(t){let{monitorEnv:e,monitor:n}=t;const{checkin_margin:o,schedule:s,schedule_type:i,max_runtime:a,timezone:l}=n.config,{onClick:d,label:c}=(0,S.Z)({text:n.slug}),p=(0,P.tZ)(f.u,{title:c,children:(0,P.BX)(z,{onClick:d,children:[(0,P.tZ)(L,{children:n.slug}),(0,P.tZ)(b.vU,{size:"xs"})]})});return(0,P.BX)(r.Fragment,{children:[(0,P.BX)(D,{children:[(0,P.tZ)(g.OT,{children:(0,v.t)("Last Check-In")}),(0,P.tZ)(g.OT,{children:(0,v.t)("Next Check-In")}),(0,P.tZ)("div",{children:e?.lastCheckIn?(0,P.tZ)(x.Z,{unitStyle:"regular",liveUpdateInterval:"second",date:e.lastCheckIn}):"-"}),(0,P.tZ)("div",{children:e?.nextCheckIn?(0,P.tZ)(x.Z,{unitStyle:"regular",liveUpdateInterval:"second",date:e.nextCheckIn}):"-"})]}),(0,P.tZ)(g.OT,{children:(0,v.t)("Schedule")}),(0,P.BX)(T,{children:[(0,P.tZ)(Z.Z,{children:(0,j.Jc)(n.config)}),i===C.Ix.CRONTAB&&(0,P.BX)($,{children:["(",s,")"]})]}),(0,P.tZ)(g.OT,{children:(0,v.t)("Thresholds")}),(0,P.BX)(E,{children:[(0,P.tZ)(N,{status:C.wo.MISSED_CHECKIN,size:12}),(0,P.tZ)(Z.Z,{children:(0,k.ri)(o)?(0,v.tn)("Check-ins missed after %s min","Check-ins missed after %s mins",o):(0,v.t)("Check-ins that are missed")}),(0,P.tZ)(N,{status:C.wo.ERROR,size:12}),(0,P.tZ)(Z.Z,{children:(0,v.tn)("Check-ins longer than %s min or errors","Check-ins longer than %s mins or errors",a??I.G)})]}),(0,P.tZ)(g.OT,{children:(0,v.t)("Cron Details")}),(0,P.BX)(y.v,{children:[(0,P.tZ)(y.G,{keyName:(0,v.t)("Monitor Slug"),value:p}),i===C.Ix.CRONTAB&&(0,P.tZ)(y.G,{keyName:(0,v.t)("Timezone"),value:l}),(0,P.tZ)(y.G,{keyName:(0,v.t)("Date created"),value:(0,w.L0)(n.dateCreated,"MMM D, YYYY")})]})]})}_.displayName="DetailsSidebar";const D=(0,o.Z)("div",{target:"eh5sblz5"})("display:grid;grid-template-columns:1fr 1fr;margin-bottom:",(0,p.D)(2),";"),T=(0,o.Z)("div",{target:"eh5sblz4"})("margin-bottom:",(0,p.D)(2),";display:flex;flex-wrap:wrap;gap:",(0,p.D)(1),";"),$=(0,o.Z)(Z.Z,{target:"eh5sblz3"})("font-family:",(t=>t.theme.text.familyMono),";color:",(t=>t.theme.subText),";"),E=(0,o.Z)("div",{target:"eh5sblz2"})("display:grid;grid-template-columns:max-content 1fr;margin-bottom:",(0,p.D)(2),";align-items:center;gap:",(0,p.D)(1),";"),z=(0,o.Z)("button",{target:"eh5sblz1"})("display:grid;grid-template-columns:1fr max-content;align-items:center;gap:",(0,p.D)(.5),";background:transparent;border:none;&:hover{color:",(t=>t.theme.textColor),";}"),L=(0,o.Z)(Z.Z,{target:"eh5sblz0"})({name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"});var B=n("./app/components/button.tsx"),M=n("./app/components/dateTime.tsx"),O=n("./app/components/duration.tsx"),G=n("./app/components/loadingError.tsx"),X=n("./app/components/pagination.tsx"),q=n("./app/components/panels/index.tsx"),R=n("./app/components/statusIndicator.tsx"),F=n("./app/utils/useLocation.tsx");const A={[C.NI.OK]:"success",[C.NI.ERROR]:"error",[C.NI.IN_PROGRESS]:"muted",[C.NI.MISSED]:"warning",[C.NI.TIMEOUT]:"error"},H={[C.NI.OK]:(0,v.t)("Okay"),[C.NI.ERROR]:(0,v.t)("Failed"),[C.NI.IN_PROGRESS]:(0,v.t)("In Progress"),[C.NI.MISSED]:(0,v.t)("Missed"),[C.NI.TIMEOUT]:(0,v.t)("Timed Out")};function U(t){let{monitor:e,monitorEnvs:n,orgId:o}=t;const s=(0,F.T)(),i=[`/organizations/${o}/monitors/${e.slug}/checkins/`,{query:{per_page:"10",environment:n.map((t=>t.name)),...s.query}}],{data:l,getResponseHeader:d,isLoading:c,isError:p}=(0,u.WE)(i,{staleTime:0});if(c)return(0,P.tZ)(a.Z,{});if(p)return(0,P.tZ)(G.Z,{});const m=(0,P.tZ)(Z.Z,{children:"—"});return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)(g.OT,{children:(0,v.t)("Recent Check-Ins")}),(0,P.tZ)(q.KB,{headers:[(0,v.t)("Status"),(0,v.t)("Started"),(0,v.t)("Duration"),(0,v.t)("Attachment"),(0,v.t)("Timestamp")],children:l.map((t=>{return(0,P.BX)(r.Fragment,{children:[(0,P.BX)(Q,{children:[(0,P.tZ)(R.Z,{status:A[t.status],tooltipTitle:(0,v._N)("Check In Status: [status]",{status:H[t.status]})}),(0,P.tZ)(Z.Z,{children:H[t.status]})]}),t.status!==C.NI.MISSED?(0,P.tZ)(M.Z,{date:t.dateCreated,timeOnly:!0}):m,(0,k.ri)(t.duration)?(0,P.tZ)(O.Z,{seconds:t.duration/1e3}):m,t.attachmentId?(0,P.tZ)(B.zx,{size:"xs",icon:(0,P.tZ)(b.Dj,{size:"xs"}),href:(n=t,`/api/0/organizations/${o}/monitors/${e.slug}/checkins/${n.id}/attachment/`),children:(0,v.t)("Attachment")}):m,(0,P.tZ)(W,{date:t.dateCreated})]},t.id);var n}))}),(0,P.tZ)(X.Z,{pageLinks:d?.("Link")})]})}U.displayName="MonitorCheckIns";const K=U,Q=(0,o.Z)("div",{target:"e1xxdkb1"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),W=(0,o.Z)(M.Z,{target:"e1xxdkb0"})("color:",(t=>t.theme.subText),";");var V=n("./app/components/breadcrumbs.tsx"),J=n("./app/components/idBadge/index.tsx"),Y=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/react-router/es/index.js")),tt=n("./app/actionCreators/monitors.tsx"),et=n("./app/components/buttonBar.tsx"),nt=n("./app/components/confirm.tsx"),ot=n("./app/utils/useApi.tsx"),rt=n("./app/utils/withDomainRequired.tsx"),st=n("./app/views/monitors/components/cronsFeedbackButton.tsx");function it(t){let{monitor:e,orgId:n,onUpdate:o}=t;const r=(0,ot.Z)(),{selection:s}=(0,h.Z)();return(0,P.BX)(et.ZP,{gap:1,children:[(0,P.tZ)(st.Z,{}),(0,P.tZ)(nt.Z,{onConfirm:async()=>{await(0,tt.Mw)(r,n,e.slug),Y.browserHistory.push((0,rt.D)(`/organizations/${n}/crons/`))},message:(0,v.t)("Are you sure you want to permanently delete this cron monitor?"),children:(0,P.tZ)(B.zx,{size:"sm",icon:(0,P.tZ)(b.Fz,{size:"xs"}),children:(0,v.t)("Delete")})}),(0,P.tZ)(B.zx,{size:"sm",icon:"disabled"!==e.status?(0,P.tZ)(b.ky,{size:"xs"}):(0,P.tZ)(b.JF,{size:"xs"}),onClick:()=>(async t=>{const s=await(0,tt.so)(r,n,e.slug,t);o?.(s)})({status:e.status===C.wo.DISABLED?C.wo.ACTIVE:C.wo.DISABLED}),children:"disabled"!==e.status?(0,v.t)("Pause"):(0,v.t)("Resume")}),(0,P.tZ)(B.zx,{priority:"primary",size:"sm",icon:(0,P.tZ)(b.yl,{size:"xs"}),to:{pathname:`/organizations/${n}/crons/${e.slug}/edit/`,query:{environment:s.environments}},children:(0,v.t)("Edit")})]})}it.displayName="MonitorHeaderActions";const at=it;function lt(t){let{monitor:e,orgId:n,onUpdate:o}=t;const r=[{label:(0,v.t)("Crons"),to:`/organizations/${n}/crons/`},{label:(0,v.t)("Cron Monitor Details")}];return(0,P.BX)(i.h4,{children:[(0,P.BX)(i.oB,{children:[(0,P.tZ)(V.Z,{crumbs:r}),(0,P.BX)(i.Dx,{children:[(0,P.tZ)(J.Z,{project:e.project,avatarSize:28,hideName:!0,avatarProps:{hasTooltip:!0,tooltip:e.project.slug}}),e.name]})]}),(0,P.tZ)(i.kP,{children:(0,P.tZ)(at,{orgId:n,monitor:e,onUpdate:o})})]})}lt.displayName="MonitorHeader";const dt=lt;var ct=n("./app/components/emptyStateWarning.tsx"),pt=n("./app/components/issues/groupList.tsx");function ut(){return(0,P.tZ)(q.s_,{children:(0,P.tZ)(q.N,{children:(0,P.tZ)(ct.Z,{children:(0,P.tZ)("p",{children:(0,v.t)("No issues relating to this cron monitor have been found.")})})})})}function mt(t){let{orgId:e,monitor:n,monitorEnvs:o}=t;const{selection:r}=(0,h.Z)(),{start:s,end:i,period:a}=r.datetime,l=s&&i?{start:(0,w.v5)(s),end:(0,w.v5)(i)}:{statsPeriod:a};return(0,P.tZ)(pt.Z,{orgId:e,endpointPath:`/organizations/${e}/issues/`,queryParams:{query:`monitor.slug:"${n.slug}" environment:[${o.map((t=>t.name)).join(",")}]`,project:n.project.id,limit:5,...l},query:"",renderEmptyMessage:ut,canSelectGroups:!1,withPagination:!1,withChart:!1,useTintRow:!1,source:"monitors"})}ut.displayName="MonitorIssuesEmptyMessage",mt.displayName="MonitorIssues";const ht=mt;var gt=n("./app/components/charts/areaChart.tsx"),yt=n("./app/components/charts/barChart.tsx"),Zt=n("./app/components/charts/miniBarChart.tsx"),xt=n("./app/components/emptyMessage.tsx"),ft=n("./app/utils/discover/charts.tsx"),bt=n("./app/utils/theme.tsx");function vt(t){let{monitor:e,monitorEnvs:n,orgId:o}=t;const{selection:s}=(0,h.Z)(),{start:i,end:l,period:d}=s.datetime,c=(0,r.useRef)(new Date);let p,m;i&&l?(m=new Date(l).getTime()/1e3,p=new Date(i).getTime()/1e3):(m=Math.floor(c.current.getTime()/1e3),p=m-(0,w.NI)(d??"30d")/1e3);const g=[`/organizations/${o}/monitors/${e.slug}/stats/`,{query:{since:p.toString(),until:m.toString(),resolution:"1d",environment:n.map((t=>t.name))}}],{data:y,isLoading:Z}=(0,u.WE)(g,{staleTime:0});if(Z)return(0,P.tZ)(a.Z,{});let x=!0;const f={seriesName:(0,v.t)("Successful"),data:[]},b={seriesName:(0,v.t)("Failed"),data:[]},k={seriesName:(0,v.t)("Missed"),data:[]},S={seriesName:(0,v.t)("Timeout"),data:[]},I={seriesName:(0,v.t)("Average Duration"),data:[]};y?.forEach((t=>{(t.ok||t.error||t.missed||t.timeout)&&(x=!1);const e=1e3*t.ts;f.data.push({name:e,value:t.ok}),b.data.push({name:e,value:t.error}),S.data.push({name:e,value:t.timeout}),k.data.push({name:e,value:t.missed}),I.data.push({name:e,value:Math.trunc(t.duration)})}));const C=[bt.ZP.green200,bt.ZP.red200,bt.ZP.red200,bt.ZP.yellow200],N=t=>({max:(0,Zt.v)(150),splitLine:{show:!1},axisLabel:{formatter:e=>(0,ft.gu)(e,t,!0),showMaxLabel:!1}});return x?(0,P.tZ)(q.s_,{children:(0,P.tZ)(q.N,{withPadding:!0,children:(0,P.tZ)(xt.Z,{title:(0,v.t)("No check-ins have been recorded for this time period.")})})}):(0,P.BX)(r.Fragment,{children:[(0,P.tZ)(q.s_,{children:(0,P.BX)(q.N,{withPadding:!0,children:[(0,P.tZ)(kt,{children:(0,v.t)("Check-Ins")}),(0,P.tZ)(yt.v,{isGroupedByDate:!0,showTimeInTooltip:!0,useShortDate:!0,series:[f,b,S,k],stacked:!0,height:150,colors:C,tooltip:{trigger:"axis"},yAxis:N("number"),grid:{top:6,bottom:0,left:0,right:0},animation:!1})]})}),(0,P.tZ)(q.s_,{children:(0,P.BX)(q.N,{withPadding:!0,children:[(0,P.tZ)(kt,{children:(0,v.t)("Average Duration")}),(0,P.tZ)(gt.T,{isGroupedByDate:!0,showTimeInTooltip:!0,useShortDate:!0,series:[I],height:150,colors:[bt.ZP.charts.colors[0]],yAxis:N("duration"),grid:{top:6,bottom:0,left:0,right:0},tooltip:{valueFormatter:t=>(0,ft.CX)(t,"duration")}})]})})]})}vt.displayName="MonitorStats";const kt=(0,o.Z)(g.Gh,{target:"e1ctkj3r0"})("margin-bottom:",(0,p.D)(1),";"),wt=vt;var St=n("./app/components/links/externalLink.tsx"),It=n("./app/components/onboardingPanel.tsx"),Ct=n("../node_modules/lodash/partition.js"),Nt=n.n(Ct),jt=n("./app/components/compactSelect/index.tsx"),Pt=n("../node_modules/lodash/merge.js"),_t=n.n(Pt),Dt=n("./app/components/codeSnippet.tsx");const Tt={dsnKey:"<my-dsn-key>",orgSlug:"<my-organization-slug>",slug:"<my-monitor-slug>"};function $t(t){return _t()(Tt,t)}function Et(t){const{slug:e}=$t(t),n=`import sentry_sdk\nfrom sentry_sdk.crons import monitor\n\n# Add this decorator to instrument your python function\n@monitor(monitor_slug='${e}')\ndef tell_the_world(msg):\n    print(msg)`;return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)("div",{children:(0,v._N)("[installLink:Install and configure] the Sentry Python SDK (min v1.17.0), then instrument your monitor:",{installLink:(0,P.tZ)(St.Z,{href:"https://docs.sentry.io/platforms/python/"})})}),(0,P.tZ)(Dt.O,{language:"python",children:n})]})}function zt(t){const{slug:e,dsnKey:n}=$t(t),o=`import sentry_sdk\nfrom sentry_sdk.crons import monitor\nfrom sentry_sdk.integrations.celery import CeleryIntegration\n\n# @signals.celeryd_init.connect\n@signals.beat_init.connect\ndef init_sentry(**kwargs):\n    sentry_sdk.init(\n        dsn='${n}',\n        integrations=[CeleryIntegration()],\n    )\n`,s=`@app.task\n@monitor(monitor_slug='${e}')\ndef tell_the_world(msg):\n    print(msg)\n`;return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)("div",{children:(0,v._N)("[installLink:Install and configure] the Sentry Python SDK (min v1.17.0), then initialize Sentry either in [celerydInit:celeryd_init] or [beatInit:beat_init] signal:",{celerydInit:(0,P.tZ)("code",{}),beatInit:(0,P.tZ)("code",{}),installLink:(0,P.tZ)(St.Z,{href:"https://docs.sentry.io/platforms/python/guides/celery/"})})}),(0,P.tZ)(Dt.O,{language:"python",children:o}),(0,P.tZ)("div",{children:(0,v.t)("Link your Celery task to your Monitor:")}),(0,P.tZ)(Dt.O,{language:"python",children:s})]})}function Lt(t){const{slug:e,dsnKey:n}=$t(t),o=`# Example for a Python script:\nexport SENTRY_DSN=${n}\nsentry-cli monitors run ${e} -- python path/to/file`;return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)("div",{children:(0,v._N)("Make sure to [installLink:install the Sentry CLI] (min v2.16.1), then instrument your monitor:",{installLink:(0,P.tZ)(St.Z,{href:"https://docs.sentry.io/product/cli/installation/"})})}),(0,P.tZ)(Dt.O,{language:"bash",children:o})]})}function Bt(t){const{slug:e,orgSlug:n,dsnKey:o}=$t(t),s=`# Notify Sentry your job is running:\ncurl -X POST \\\n    'https://sentry.io/api/0/organizations/${n}/monitors/${e}/checkins/' \\\n    --header 'Authorization: DSN ${o}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{"status": "in_progress"}'\n\n# Execute your scheduled task here...\n\n# Notify Sentry your job has completed successfully:\ncurl -X PUT \\\n    'https://sentry.io/api/0/organizations/${n}/monitors/${e}/checkins/latest/' \\\n    --header 'Authorization: DSN ${o}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{"status": "ok"}'`,i=`# Notify Sentry your job has failed:\ncurl -X PUT \\\n    'https://sentry.io/api/0/organizations/${n}/monitors/${e}/checkins/latest/' \\\n    --header 'Authorization: DSN ${o}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{"status": "error"}'`;return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)(Dt.O,{language:"bash",children:s}),(0,P.tZ)("div",{children:(0,v.t)("To notify Sentry if your job execution fails")}),(0,P.tZ)(Dt.O,{language:"bash",children:i})]})}function Mt(t){const{slug:e}=$t(t),n=`// 🟡 Notify Sentry your job is running:\n$event = Event::createCheckIn();\n$checkIn = new CheckIn(\n    monitorSlug: '${e}',\n    status: CheckInStatus::inProgress(),\n);\n$event->setCheckIn($checkIn);\nSentrySdk::getCurrentHub()->captureEvent($event);\n\n// Execute your scheduled task here...\n\n// 🟢 Notify Sentry your job has completed successfully:\n$event = Event::createCheckIn();\n$event->setCheckIn(new CheckIn(\n    id: $checkIn->getId(),\n    monitorSlug: '${e}',\n    status: CheckInStatus::ok(),\n));\nSentrySdk::getCurrentHub()->captureEvent($event);`,o=`// 🔴 Notify Sentry your job has failed:\n$event = Event::createCheckIn();\n$event->setCheckIn(new CheckIn(\n    id: $checkIn->getId(),\n    monitorSlug: '${e}',\n    status: CheckInStatus::error(),\n));\nSentrySdk::getCurrentHub()->captureEvent($event);`;return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)("div",{children:(0,v._N)("[installLink:Install and configure] the Sentry PHP SDK (min v3.16.0), then instrument your monitor:",{installLink:(0,P.tZ)(St.Z,{href:"https://docs.sentry.io/platforms/php/"})})}),(0,P.tZ)(Dt.O,{language:"php",children:n}),(0,P.tZ)("div",{children:(0,v.t)("To notify Sentry if your job execution fails")}),(0,P.tZ)(Dt.O,{language:"php",children:o})]})}function Ot(t){const{slug:e}=$t(t),n=`protected function schedule(Schedule $schedule)\n{\n    $schedule->command('emails:send')\n        ->everyHour()\n        ->sentryMonitor('${e}'); // add this line\n}`;return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)("div",{children:(0,v._N)("[installLink:Install and configure] the Sentry PHP Laravel SDK (min v3.3.1), then add the [sentryMonitor:sentryMonitor()] call to your scheduled tasks defined in your [kernel:app/Console/Kernel.php] file:",{sentryMonitor:(0,P.tZ)("code",{}),kernel:(0,P.tZ)("code",{}),installLink:(0,P.tZ)(St.Z,{href:"https://docs.sentry.io/platforms/php/guides/laravel/"})})}),(0,P.tZ)(Dt.O,{language:"php",children:n})]})}function Gt(t){const{slug:e}=$t(t),n=`// 🟡 Notify Sentry your job is running:\nconst checkInId = Sentry.captureCheckIn({\n  monitorSlug: "${e}",\n  status: "in_progress",\n});\n\n// Execute your scheduled task here...\n\n// 🟢 Notify Sentry your job has completed successfully:\nSentry.captureCheckIn({\n  checkInId,\n  monitorSlug: "${e}",\n  status: "ok",\n});`,o=`// 🔴 Notify Sentry your job has failed:\nSentry.captureCheckIn({\n  checkInId,\n  monitorSlug: "${e}",\n  status: "error",\n});`;return(0,P.BX)(r.Fragment,{children:[(0,P.tZ)("div",{children:(0,v._N)("[installLink:Install and configure] the Sentry Node SDK (min v7.52), then instrument your monitor:",{installLink:(0,P.tZ)(St.Z,{href:"https://docs.sentry.io/platforms/node/"})})}),(0,P.tZ)(Dt.O,{language:"javascript",children:n}),(0,P.tZ)("div",{children:(0,v.t)("To notify Sentry if your job execution fails")}),(0,P.tZ)(Dt.O,{language:"javascript",children:o})]})}Et.displayName="PythonCronQuickStart",zt.displayName="PythonCeleryCronQuickStart",Lt.displayName="CLICronQuickStart",Bt.displayName="CurlCronQuickStart",Mt.displayName="PHPCronQuickStart",Ot.displayName="PHPLaravelCronQuickStart",Gt.displayName="NodeJSCronQuickStart";const Xt={cli:{label:"Sentry CLI",Guide:Lt},curl:{label:"cURL",Guide:Bt},python:{label:"Python",Guide:Et,platforms:new Set(["python","python-django","python-flask","python-fastapi","python-starlette","python-sanic","python-bottle","python-pylons","python-pyramid","python-tornado","python-rq"])},pythonCelery:{label:"Celery",Guide:zt,platforms:new Set(["python-celery"])},php:{label:"PHP",Guide:Mt,platforms:new Set(["php","php-monolog","php-symfony2"])},phpLaravel:{label:"Laravel",Guide:Ot,platforms:new Set(["php-laravel"])},nodeJs:{label:"Node",Guide:Gt,platforms:new Set(["node"])}},qt=t=>{let{key:e,label:n}=t;return{label:n,value:e}};function Rt(t){let{monitor:e,orgId:n}=t;const{data:o}=(0,u.WE)([`/projects/${n}/${e.project.slug}/keys/`],{staleTime:1/0}),s=Object.entries(Xt).map((t=>{let[e,n]=t;return{...n,key:e}})),[i,a]=Nt()(s,(t=>void 0===t.platforms)),l=[{label:(0,v.t)("Platform Specfiic"),options:a.map(qt)},{label:(0,v.t)("Generic"),options:i.map(qt)}],d=a.filter((t=>t.platforms?.has(e.project.platform??"other"))),c=d.length>0?d[0].key:"cli",[p,m]=(0,r.useState)(c),{Guide:h}=Xt[p];return(0,P.BX)(Ft,{children:[(0,P.tZ)(jt.Z,{options:l,value:p,onChange:t=>{let{value:e}=t;return m(e)}}),(0,P.tZ)(h,{slug:e.slug,orgSlug:n,dsnKey:o?.[0].dsn.public})]})}Rt.displayName="MonitorQuickStartGuide";const Ft=(0,o.Z)("div",{target:"eyxg6xo0"})("display:flex;flex-direction:column;gap:",(0,p.D)(2),";");function At(t){let{orgId:e,monitor:n}=t;return(0,P.BX)(It.Z,{noCenter:!0,children:[(0,P.tZ)("h3",{children:(0,v.t)("Instrument your monitor")}),(0,P.tZ)("p",{children:(0,v._N)("Select an integration method for your new monitor. For in-depth instructions on integrating Crons, view [docsLink:our complete documentation].",{docsLink:(0,P.tZ)(St.Z,{href:"https://docs.sentry.io/product/crons/getting-started/"})})}),(0,P.tZ)(Rt,{orgId:e,monitor:n})]})}At.displayName="MonitorOnboarding";const Ht=At;function Ut(t){return t.environments.some((t=>t.lastCheckIn))}function Kt(t){let{params:e,location:n}=t;const{selection:o}=(0,h.Z)(),d=(0,m.Z)(),p=(0,u.NL)(),g=o.environments[0],y=[`/organizations/${d.slug}/monitors/${e.monitorSlug}/`,{query:{...n.query,environment:g}}],{data:Z}=(0,u.WE)(y,{staleTime:0,refetchInterval:t=>{if(!t)return!1;const[e]=t;return!Ut(e)&&5e3}});if(!Z)return(0,P.tZ)(i.T3,{children:(0,P.tZ)(a.Z,{})});const x=Z.environments.sort(((t,e)=>t.lastCheckIn.localeCompare(e.lastCheckIn)));return(0,P.tZ)(c.Z,{title:`Crons — ${Z.name}`,children:(0,P.BX)(i.T3,{children:[(0,P.tZ)(dt,{monitor:Z,orgId:d.slug,onUpdate:function(t){const e={...t,environments:Z?.environments};(0,u.XN)(p,y,e)}}),(0,P.BX)(i.uT,{children:[(0,P.BX)(i.or,{children:[(0,P.BX)(Qt,{condensed:!0,children:[(0,P.tZ)(s.Z,{alignDropdown:"left"}),(0,P.tZ)(l.y,{})]}),Ut(Z)?(0,P.BX)(r.Fragment,{children:[(0,P.tZ)(wt,{orgId:d.slug,monitor:Z,monitorEnvs:Z.environments}),(0,P.tZ)(ht,{orgId:d.slug,monitor:Z,monitorEnvs:Z.environments}),(0,P.tZ)(K,{orgId:d.slug,monitor:Z,monitorEnvs:Z.environments})]}):(0,P.tZ)(Ht,{orgId:d.slug,monitor:Z})]}),(0,P.tZ)(i.MF,{children:(0,P.tZ)(_,{monitorEnv:x[x.length-1],monitor:Z})})]})]})})}Kt.displayName="MonitorDetails";const Qt=(0,o.Z)(d.Z,{target:"eokg3rx0"})("margin-bottom:",(0,p.D)(2),";"),Wt=Kt}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_details_tsx.27d88adbc080e86844c39e3ba66b71a6.js.map