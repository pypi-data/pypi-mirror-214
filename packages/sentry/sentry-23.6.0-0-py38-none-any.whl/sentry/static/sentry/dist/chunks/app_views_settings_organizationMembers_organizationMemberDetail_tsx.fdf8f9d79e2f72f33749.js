"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationMembers_organizationMemberDetail_tsx"],{"./app/components/roleSelectControl.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/forms/controls/selectControl.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{roles:t,disableUnallowed:s,...o}=e;return(0,i.tZ)(n.Z,{options:t?.map((e=>({value:e.id,label:e.name,disabled:s&&!e.allowed||e.isRetired,details:(0,i.tZ)(l,{children:e.desc})}))),showDividers:!0,...o})}a.displayName="RoleSelectControl";const r=a,l=(0,o.Z)("span",{target:"eu9y8de0"})({name:"vad6xm",styles:"display:inline-block;width:20rem"})},"./app/components/teamRoleSelect.tsx":(e,t,s)=>{s.d(t,{Z:()=>m});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("./app/components/roleSelectControl.tsx")),i=s("./app/styles/space.tsx"),a=s("./app/utils/orgRole.tsx"),r=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{organization:t,team:s,member:o,onChangeTeamRole:i,disabled:d,size:m}=e;const{orgRoleList:h,teamRoleList:g,features:u}=t;if(!u.includes("team-roles"))return null;const R=[o.orgRole];o.groupOrgRoles&&o.groupOrgRoles.length>0&&R.push(o.groupOrgRoles[0].role.id),s.orgRole&&R.push(s.orgRole);const Z=(0,a.M)(R,h);if((0,r.d8)({orgRole:Z?.id,orgRoleList:h,teamRoleList:g})){const e=g.find((e=>e.id===Z?.minimumTeamRole));return(0,l.BX)(c,{children:[e?.name||Z?.minimumTeamRole,(0,l.tZ)(p,{children:(0,l.tZ)(r.Sk,{orgRole:Z?.id,orgRoleList:h,teamRoleList:g})})]})}const b=o.teamRole||o.teamRoles?.find((e=>e.teamSlug===s.slug))?.role||null,f=g.find((e=>e.id===b))||g[0];return(0,l.tZ)(n.Z,{disabled:d,disableUnallowed:!1,roles:g,value:f.id,onChange:e=>i(e.value),size:m})}d.displayName="TeamRoleSelect";const m=d,c=(0,o.Z)("div",{target:"ermz4er1"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),p=(0,o.Z)("div",{target:"ermz4er0"})("height:",(0,i.D)(2),";margin-left:",(0,i.D)(1),";")},"./app/utils/isMemberDisabledFromLimit.tsx":(e,t,s)=>{function o(e){return e?.flags["member-limit:restricted"]??!1}s.d(t,{Z:()=>o})},"./app/utils/orgRole.tsx":(e,t,s)=>{function o(e,t){const s=t.reduce(((e,t,s)=>(e[t.id]={index:s,role:t},e)),{});return e.sort(((e,t)=>s[t].index-s[e].index)),s[e[0]]?.role}s.d(t,{M:()=>o})},"./app/views/settings/organizationMembers/organizationMemberDetail.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>me});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/core-js/modules/es.regexp.flags.js"),s("../node_modules/react/index.js")),a=s("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),r=s("../node_modules/lodash/isEqual.js"),l=s.n(r),d=s("./app/actionCreators/account.tsx"),m=s("./app/actionCreators/indicator.tsx"),c=s("./app/actionCreators/members.tsx"),p=s("./app/components/button.tsx"),h=s("./app/components/buttonBar.tsx"),g=s("./app/components/confirm.tsx"),u=s("./app/components/dateTime.tsx"),R=s("./app/components/errors/notFound.tsx"),Z=s("./app/components/forms/fieldGroup/index.tsx"),b=s("./app/components/hookOrDefault.tsx"),f=s("./app/components/links/externalLink.tsx"),x=s("./app/components/panels/index.tsx"),v=s("./app/components/textCopyInput.tsx"),w=s("./app/components/tooltip.tsx"),y=s("./app/icons/index.tsx"),S=s("./app/locale.tsx"),T=s("./app/stores/configStore.tsx"),z=s("./app/styles/space.tsx"),C=s("./app/utils/isMemberDisabledFromLimit.tsx"),j=s("./app/utils/teams.tsx"),k=s("./app/utils/withDomainRequired.tsx"),B=s("./app/utils/withOrganization.tsx"),_=s("./app/views/asyncView.tsx"),I=s("./app/views/settings/components/settingsPageHeader.tsx"),L=s("../node_modules/lodash/startCase.js"),N=s.n(L),O=s("./app/components/emptyMessage.tsx"),D=s("./app/components/idBadge/teamBadge/index.tsx"),X=s("./app/components/links/link.tsx"),A=s("./app/components/loadingIndicator.tsx"),M=s("./app/components/teamRoleSelect.tsx"),F=s("./app/utils/orgRole.tsx"),E=s("./app/utils/useTeams.tsx"),P=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),U=s("./app/views/settings/organizationTeams/utils.tsx"),$=s("./app/views/settings/components/teamSelect/utils.tsx"),q=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function V(e){let{disabled:t,loadingTeams:s,member:o,selectedOrgRole:n,selectedTeamRoles:a,organization:r,onAddTeam:l,onRemoveTeam:d,onCreateTeam:m,onChangeTeamRole:c}=e;const{teams:p,onSearch:h,fetching:g}=(0,E.y)(),{orgRoleList:u,teamRoleList:R}=r,Z=new Set(a.map((e=>e.teamSlug))),b=p.filter((e=>Z.has(e.slug))),f=b.filter((e=>e.orgRole)).map((e=>e.orgRole));n&&f.push(n);const v=(0,F.M)(f,u);return(0,q.BX)(x.s_,{children:[(0,q.BX)(x.V9,{hasButtons:!0,children:[(0,S.t)("Team"),(0,q.tZ)($.w,{disabled:t,isLoadingTeams:g,isAddingTeamToMember:!0,canCreateTeam:!1,onSearch:h,onSelect:l,onCreateTeam:m,organization:r,selectedTeams:b.map((e=>e.slug)),teams:p})]}),(0,q.tZ)(x.N,{children:s?(0,q.tZ)(A.Z,{}):0===b.length?(0,q.tZ)(O.Z,{children:(0,S.t)("No Teams assigned")}):(0,q.BX)(i.Fragment,{children:[r.features.includes("team-roles")&&v&&(0,q.tZ)(P.pu,{orgRole:v?.id,orgRoleList:u,teamRoleList:R}),b.map((e=>(0,q.tZ)(G,{disabled:t,organization:r,team:e,member:{...o,groupOrgRoles:[{role:v,teamSlug:""}],orgRole:n,teamRoles:a},onChangeTeamRole:c,onRemoveTeam:e=>d(e)},e.slug)))]})})]})}function G(e){let{disabled:t,organization:s,team:o,member:n,onRemoveTeam:i,onChangeTeamRole:a}=e;const r=s.access.includes("org:admin"),l=o.flags["idp:provisioned"],d=null!==o.orgRole&&!r,m=t||l||d,c=(0,U.m)(l,d),h=o.orgRole?`${N()(o.orgRole)} Team`:null;return(0,q.BX)(J,{"data-test-id":"team-row-for-member",children:[(0,q.tZ)(W,{children:(0,q.tZ)(X.Z,{to:`/settings/${s.slug}/teams/${o.slug}/`,children:(0,q.tZ)(D.a,{team:o})})}),(0,q.tZ)(Y,{children:h}),s.features.includes("team-roles")&&(0,q.tZ)(H,{children:(0,q.tZ)(M.Z,{disabled:t,size:"xs",organization:s,team:o,member:n,onChangeTeamRole:e=>a(o.slug,e)})}),(0,q.tZ)(p.zx,{size:"xs",icon:(0,q.tZ)(y.JZ,{isCircled:!0,size:"xs"}),title:c,disabled:m,onClick:()=>i(o.slug),children:(0,S.t)("Remove")})]})}V.displayName="TeamSelect",G.displayName="TeamRow";const J=(0,n.Z)(x.Lv,{target:"e21fr73"})("padding:",(0,z.D)(2),";align-items:center;justify-content:space-between;"),W=(0,n.Z)("div",{target:"e21fr72"})({name:"aco78w",styles:"flex-grow:4"}),Y=(0,n.Z)("div",{target:"e21fr71"})({name:"1k42tn9",styles:"min-width:90px;flex-grow:1;display:flex;justify-content:center"}),H=(0,n.Z)("div",{target:"e21fr70"})("min-width:200px;margin-right:",(0,z.D)(2),";"),K=V;var Q=s("./app/components/radio.tsx"),ee=s("./app/views/settings/components/text/textBlock.tsx");const te=(0,n.Z)("label",{target:"e1vdkxph0"})({name:"ddvan8",styles:"display:flex;flex:1;align-items:center;margin-bottom:0"});class se extends i.Component{render(){const{disabled:e,enforceRetired:t,enforceAllowed:s,isCurrentUser:o,roleList:n,enforceIdpRoleRestricted:i,roleSelected:a,setSelected:r}=this.props;return(0,q.BX)(x.s_,{children:[(0,q.tZ)(x.V9,{children:(0,q.tZ)("div",{children:(0,S.t)("Organization Role")})}),i&&(0,q.tZ)(x.aU,{children:(0,S._N)("[person] organization-level role is managed through your organization's identity provider.",{person:o?"Your":"This member's"})}),(0,q.tZ)(x.N,{children:n.map((o=>{const{desc:n,name:l,id:d,allowed:m,isRetired:c}=o,p=e||t&&c||s&&!m||i;return(0,q.tZ)(x.Lv,{onClick:()=>!p&&r(d),css:p?{color:"grey",cursor:"default"}:{},children:(0,q.BX)(te,{children:[(0,q.tZ)(Q.Z,{id:d,value:l,checked:d===a,readOnly:!0}),(0,q.BX)("div",{style:{flex:1,padding:"0 16px"},children:[l,(0,q.tZ)(ee.Z,{noMargin:!0,children:(0,q.tZ)("div",{className:"help-block",children:n})})]})]})},d)}))})]})}}se.displayName="OrganizationRoleSelect";const oe=se,ne=(0,S.t)("Cannot be reset since user is in more than one organization"),ie=(0,S.t)("Not enrolled in two-factor authentication"),ae=(0,S.t)("You do not have permission to perform this action"),re=(0,S.t)("Cannot be reset since two-factor is required for this organization"),le=(0,b.Z)({hookName:"component:disabled-member-tooltip",defaultComponent:e=>{let{children:t}=e;return(0,q.tZ)(i.Fragment,{children:t})}});class de extends _.Z{constructor(){super(...arguments),(0,o.Z)(this,"handleSave",(async()=>{const{organization:e,params:t}=this.props,{orgRole:s,teamRoles:o}=this.state;(0,m.E3)((0,S.t)("Saving...")),this.setState({busy:!0});try{const n=await(0,c.hS)(this.api,{orgId:e.slug,memberId:t.memberId,data:{orgRole:s,teamRoles:o}});this.setState({member:n,orgRole:n.orgRole,teamRoles:n.teamRoles,busy:!1}),(0,m.S9)((0,S.t)("Saved"))}catch(e){const t=e&&e.responseJSON&&e.responseJSON.detail||(0,S.t)("Could not save...");this.setState({busy:!1}),(0,m.Iw)(t)}})),(0,o.Z)(this,"handleInvite",(async e=>{const{organization:t,params:s}=this.props;(0,m.E3)((0,S.t)("Sending invite...")),this.setState({busy:!0});try{const o=await(0,c.R_)(this.api,{orgId:t.slug,memberId:s.memberId,regenerate:e});(0,m.S9)((0,S.t)("Sent invite!")),e&&this.setState((e=>({member:{...e.member,...o}})))}catch(e){(0,m.Iw)((0,S.t)("Could not send invite"))}this.setState({busy:!1})})),(0,o.Z)(this,"handle2faReset",(async()=>{const{organization:e,router:t}=this.props,{user:s}=this.state.member,o=s?.authenticators.map((e=>(0,d.Hb)(this.api,s.id,e.id)))??[];try{await Promise.all(o),t.push((0,k.D)(`/settings/${e.slug}/members/`)),(0,m.S9)((0,S.t)("All authenticators have been removed"))}catch(e){(0,m.Iw)((0,S.t)("Error removing authenticators")),a.Tb(e)}})),(0,o.Z)(this,"onAddTeam",(e=>{const t=[...this.state.teamRoles];-1===t.findIndex((t=>t.teamSlug===e))&&(t.push({teamSlug:e,role:null}),this.setState({teamRoles:t}))})),(0,o.Z)(this,"onRemoveTeam",(e=>{const t=this.state.teamRoles.filter((t=>t.teamSlug!==e));this.setState({teamRoles:t})})),(0,o.Z)(this,"onChangeOrgRole",(e=>this.setState({orgRole:e}))),(0,o.Z)(this,"onChangeTeamRole",((e,t)=>{if(!this.hasTeamRoles)return;const s=[...this.state.teamRoles],o=s.findIndex((t=>t.teamSlug===e));-1!==o&&(s[o]={...s[o],role:t},this.setState({teamRoles:s}))})),(0,o.Z)(this,"showResetButton",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:s}=t;return!(!s||!s.authenticators||e.require2FA)&&(s.authenticators.length>=1&&s.canReset2fa)})),(0,o.Z)(this,"getTooltip",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:s}=t;return s?s.authenticators?s.authenticators.length?s.canReset2fa?e.require2FA?re:"":ne:ie:ae:""}))}get hasTeamRoles(){const{organization:e}=this.props;return e.features.includes("team-roles")}getDefaultState(){return{...super.getDefaultState(),groupOrgRoles:[],member:null,orgRole:"",teamRoles:[]}}getEndpoints(){const{organization:e,params:t}=this.props;return[["member",`/organizations/${e.slug}/members/${t.memberId}/`]]}onRequestSuccess(e){let{data:t,stateKey:s}=e;if("member"===s){const{orgRole:e,teamRoles:s,groupOrgRoles:o}=t;this.setState({orgRole:e,teamRoles:s,groupOrgRoles:o})}}get memberDeactivated(){return(0,C.Z)(this.state.member)}get hasFormChanged(){const{member:e,orgRole:t,teamRoles:s}=this.state;return!(!e||t===e.orgRole&&l()(s,e.teamRoles))}renderMemberStatus(e){return this.memberDeactivated?(0,q.tZ)("em",{children:(0,q.tZ)(le,{children:(0,S.t)("Deactivated")})}):e.expired?(0,q.tZ)("em",{children:(0,S.t)("Invitation Expired")}):e.pending?(0,q.tZ)("em",{children:(0,S.t)("Invitation Pending")}):(0,S.t)("Active")}renderBody(){const{organization:e}=this.props,{member:t,orgRole:s,teamRoles:o}=this.state;if(!t)return(0,q.tZ)(R.Z,{});const{access:n,features:a,orgRoleList:r}=e,l=n.includes("org:write")&&!this.memberDeactivated,d=a.includes("team-roles"),{email:m,expired:c,pending:b,invite_link:z}=t,C=!c,k=!b,B=T.Z.get("user").email===m;return(0,q.BX)(i.Fragment,{children:[(0,q.tZ)(I.Z,{title:(0,q.BX)(i.Fragment,{children:[(0,q.tZ)("div",{children:t.name}),(0,q.tZ)(ce,{children:(0,S.t)("Member Settings")})]})}),(0,q.BX)(x.s_,{children:[(0,q.tZ)(x.V9,{children:(0,S.t)("Basics")}),(0,q.BX)(x.N,{children:[(0,q.tZ)(x.Lv,{children:(0,q.BX)(pe,{children:[(0,q.BX)("div",{children:[(0,q.tZ)(he,{children:(0,S.t)("Email")}),(0,q.tZ)("div",{children:(0,q.tZ)(f.Z,{href:`mailto:${m}`,children:m})})]}),(0,q.BX)("div",{children:[(0,q.tZ)(he,{children:(0,S.t)("Status")}),(0,q.tZ)("div",{"data-test-id":"member-status",children:this.renderMemberStatus(t)})]}),(0,q.BX)("div",{children:[(0,q.tZ)(he,{children:(0,S.t)("Added")}),(0,q.tZ)("div",{children:(0,q.tZ)(u.Z,{dateOnly:!0,date:t.dateCreated})})]})]})}),(0,q.tZ)(x.Lv,{children:z&&(0,q.BX)(ue,{children:[(0,q.BX)(ge,{children:[(0,q.tZ)(he,{children:(0,S.t)("Invite Link")}),(0,q.tZ)(v.Z,{children:z}),(0,q.tZ)("p",{className:"help-block",children:(0,S.t)("This invite link can be used by anyone who knows it. Keep it secure!")})]}),(0,q.BX)(h.ZP,{gap:1,children:[C&&(0,q.tZ)(p.zx,{"data-test-id":"resend-invite",onClick:()=>this.handleInvite(!1),children:(0,S.t)("Resend Invite")}),(0,q.tZ)(p.zx,{onClick:()=>this.handleInvite(!0),title:(0,S.t)("Generate New Invite. This will invalidate the previous invite link!"),priority:"danger","aria-label":(0,S.t)("Generate New Invite"),icon:(0,q.tZ)(y.tr,{size:"sm"})})]})]})})]})]}),k&&(0,q.BX)(x.s_,{children:[(0,q.tZ)(x.V9,{children:(0,S.t)("Authentication")}),(0,q.tZ)(x.N,{children:(0,q.tZ)(Z.Z,{alignRight:!0,flexibleControlStateSize:!0,label:(0,S.t)("Reset two-factor authentication"),help:(0,S.t)("Resetting two-factor authentication will remove all two-factor authentication methods for this member."),children:(0,q.tZ)(w.u,{disabled:this.showResetButton(),title:this.getTooltip(),children:(0,q.tZ)(g.Z,{disabled:!this.showResetButton(),message:(0,S._N)("Are you sure you want to disable all two-factor authentication methods for [name]?",{name:t.name?t.name:"this member"}),onConfirm:this.handle2faReset,children:(0,q.tZ)(p.zx,{priority:"danger",children:(0,S.t)("Reset two-factor authentication")})})})})})]}),(0,q.tZ)(oe,{enforceAllowed:!1,enforceIdpRoleRestricted:t.flags["idp:role-restricted"],enforceRetired:d,isCurrentUser:B,disabled:!l,roleList:r,roleSelected:s,setSelected:this.onChangeOrgRole}),(0,q.tZ)(j.Z,{slugs:t.teams,children:n=>{let{initiallyLoaded:a}=n;return(0,q.tZ)(i.Fragment,{children:(0,q.tZ)(K,{disabled:!l,organization:e,member:t,selectedOrgRole:s,selectedTeamRoles:o,onChangeTeamRole:this.onChangeTeamRole,onAddTeam:this.onAddTeam,onRemoveTeam:this.onRemoveTeam,loadingTeams:!a})})}}),(0,q.tZ)(Re,{children:(0,q.tZ)(p.zx,{priority:"primary",busy:this.state.busy,onClick:this.handleSave,disabled:!l||!this.hasFormChanged,children:(0,S.t)("Save Member")})})]})}}const me=(0,B.Z)(de),ce=(0,n.Z)("div",{target:"e1mjm7f05"})("color:",(e=>e.theme.gray300),";font-weight:normal;font-size:",(e=>e.theme.fontSizeLarge),";"),pe=(0,n.Z)("div",{target:"e1mjm7f04"})("display:grid;grid-auto-flow:column;grid-template-columns:2fr 1fr 1fr;gap:",(0,z.D)(2),";width:100%;@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-auto-flow:row;grid-template-columns:auto;}"),he=(0,n.Z)("div",{target:"e1mjm7f03"})("font-weight:bold;margin-bottom:",(0,z.D)(.5),";color:",(e=>e.theme.textColor),";"),ge=(0,n.Z)("div",{target:"e1mjm7f02"})({name:"1ff36h2",styles:"flex-grow:1"}),ue=(0,n.Z)("div",{target:"e1mjm7f01"})("flex-grow:1;display:flex;gap:",(0,z.D)(1),";"),Re=(0,n.Z)("div",{target:"e1mjm7f00"})({name:"skgbeu",styles:"display:flex;justify-content:flex-end"})},"./app/views/settings/organizationTeams/roleOverwriteWarning.tsx":(e,t,s)=>{s.d(t,{Sk:()=>l,d8:()=>m,pu:()=>d});var o=s("./app/components/panels/index.tsx"),n=s("./app/components/tooltip.tsx"),i=s("./app/icons/index.tsx"),a=s("./app/locale.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){return m(e)?(0,r.tZ)(n.u,{title:c(e),children:(0,r.tZ)(i.aU,{size:"sm",color:"gray300"})}):null}function d(e){return m(e)?(0,r.tZ)(o.aU,{"data-test-id":"alert-role-overwrite",children:c(e)}):null}function m(e){const{orgRole:t,orgRoleList:s,teamRoleList:o}=e,n=s.find((e=>e.id===t));return o.findIndex((e=>e.id===n?.minimumTeamRole))>0}function c(e){const{orgRole:t,orgRoleList:s,teamRoleList:o,isSelf:n}=e,i=s.find((e=>e.id===t)),l=o.find((e=>e.id===i?.minimumTeamRole));return i&&l?(0,a._N)("[selfNoun] organization role as [article] [orgRole] has granted [selfPronoun] a minimum team-level role of [teamRole]",{selfNoun:n?"Your":"This user's",selfPronoun:n?"you":"them",article:"AEIOU".includes(i.name[0])?"an":"a",orgRole:(0,r.tZ)("strong",{children:i.name}),teamRole:(0,r.tZ)("strong",{children:l.name})}):""}l.displayName="RoleOverwriteIcon",d.displayName="RoleOverwritePanelAlert"}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationMembers_organizationMemberDetail_tsx.066454ef7932042abbb728d55dc882f8.js.map