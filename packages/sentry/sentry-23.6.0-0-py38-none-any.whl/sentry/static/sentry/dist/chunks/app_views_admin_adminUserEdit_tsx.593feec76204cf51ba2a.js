"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_admin_adminUserEdit_tsx"],{"./app/views/admin/adminUserEdit.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("../node_modules/react/index.js"),a=s("../node_modules/react-router/es/index.js"),o=s("./app/actionCreators/indicator.tsx"),d=s("./app/actionCreators/modal.tsx"),l=s("./app/components/button.tsx"),p=s("./app/components/forms/controls/radioGroup.tsx"),m=s("./app/components/forms/form.tsx"),u=s("./app/components/forms/jsonForm.tsx"),c=s("./app/components/forms/model.tsx"),h=s("./app/locale.tsx"),b=s("./app/styles/space.tsx"),x=s("./app/views/asyncView.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const g={title:"User details",fields:[{name:"name",type:"string",required:!0,label:(0,h.t)("Name")},{name:"username",type:"string",required:!0,label:(0,h.t)("Username"),help:(0,h.t)("The username is the unique id of the user in the system")},{name:"email",type:"string",required:!0,label:(0,h.t)("Email"),help:(0,h.t)("The users primary email address")},{name:"isActive",type:"boolean",required:!0,label:(0,h.t)("Active"),help:(0,h.t)("Designates whether this user should be treated as active. Unselect this instead of deleting accounts.")},{name:"isStaff",type:"boolean",required:!0,label:(0,h.t)("Admin"),help:(0,h.t)("Designates whether this user can perform administrative functions.")},{name:"isSuperuser",type:"boolean",required:!0,label:(0,h.t)("Superuser"),help:(0,h.t)("Designates whether this user has all permissions without explicitly assigning them.")}]},v={disable:(0,h.t)("Disable User"),delete:(0,h.t)("Permanently Delete User")};class Z extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{deleteType:"disable"}),(0,r.Z)(this,"onRemove",(()=>{this.props.onRemove(this.state.deleteType),this.props.closeModal()}))}render(){const{user:e}=this.props,{deleteType:t}=this.state;return(0,y.BX)(n.Fragment,{children:[(0,y.tZ)(p.Z,{value:t,label:(0,h.t)("Remove user %s",e.email),onChange:e=>this.setState({deleteType:e}),choices:[["disable",(0,h.t)("Disable the account.")],["delete",(0,h.t)("Permanently remove the user and their data.")]]}),(0,y.BX)(w,{children:[(0,y.tZ)(l.zx,{priority:"danger",onClick:this.onRemove,children:v[t]}),(0,y.tZ)(l.zx,{onClick:this.props.closeModal,children:(0,h.t)("Cancel")})]})]})}}Z.displayName="RemoveUserModal";class f extends x.Z{constructor(){super(...arguments),(0,r.Z)(this,"removeUser",(e=>"delete"===e?this.deleteUser():this.deactivateUser())),(0,r.Z)(this,"formModel",new c.Z)}get userEndpoint(){const{params:e}=this.props;return`/users/${e.id}/`}getEndpoints(){return[["user",this.userEndpoint]]}async deleteUser(){await this.api.requestPromise(this.userEndpoint,{method:"DELETE",data:{hardDelete:!0,organizations:[]}}),(0,o.S9)((0,h.t)("%s's account has been deleted.",this.state.user?.email)),a.browserHistory.replace("/manage/users/")}async deactivateUser(){const e=await this.api.requestPromise(this.userEndpoint,{method:"PUT",data:{isActive:!1}});this.setState({user:e}),this.formModel.setInitialData(e),(0,o.S9)((0,h.t)("%s's account has been deactivated.",e.email))}renderBody(){const{user:e}=this.state;return null===e?null:(0,y.BX)(n.Fragment,{children:[(0,y.tZ)("h3",{children:(0,h.t)("Users")}),(0,y.tZ)("p",{children:(0,h.t)("Editing user: %s",e.email)}),(0,y.tZ)(m.Z,{model:this.formModel,initialData:e,apiMethod:"PUT",apiEndpoint:this.userEndpoint,requireChanges:!0,onSubmitError:e=>{(0,o.Iw)(e?.responseJSON?.detail)},onSubmitSuccess:e=>{this.setState({user:e}),(0,o.S9)((0,h.t)("User account updated."))},extraButton:(0,y.tZ)(l.zx,{onClick:()=>(0,d.openModal)((t=>(0,y.tZ)(Z,{user:e,onRemove:this.removeUser,...t}))),style:{marginLeft:(0,b.D)(1)},priority:"danger",children:(0,h.t)("Remove User")}),children:(0,y.tZ)(u.Z,{forms:[g]})})]})}}const w=(0,i.Z)("div",{target:"e1uf1rgd0"})("display:grid;grid-auto-flow:column;gap:",(0,b.D)(1),";justify-content:end;padding:20px 30px;margin:20px -30px -30px;border-top:1px solid ",(e=>e.theme.border),";"),U=f},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});var r=s("./app/components/asyncComponent.tsx"),i=s("./app/components/sentryDocumentTitle.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends r.Z{getTitle(){return""}render(){return(0,n.tZ)(i.Z,{title:this.getTitle(),children:this.renderComponent()})}}a.displayName="AsyncView"}}]);
//# sourceMappingURL=../sourcemaps/app_views_admin_adminUserEdit_tsx.592939bfa0948f966fc77da650c69c52.js.map