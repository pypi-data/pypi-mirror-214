"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_projectIssueGrouping_index_tsx"],{"./app/data/forms/projectIssueGrouping.tsx":(e,t,n)=>{n.r(t),n.d(t,{fields:()=>d,route:()=>c});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("../node_modules/react/index.js"),i=n("./app/components/events/groupingInfo/index.tsx"),s=n("./app/components/links/externalLink.tsx"),a=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),l=n("./app/utils/marked.tsx"),g=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c="/settings/:orgId/projects/:projectId/issue-grouping/",u={name:"groupingConfig",type:"select",label:(0,a.t)("Grouping Config"),saveOnBlur:!1,saveMessageAlertType:"info",saveMessage:(0,a.t)("Changing grouping config will apply to future events only (can take up to a minute)."),selectionInfoFunction:e=>{const{groupingConfigs:t,value:n}=e,o=t.find((e=>{let{id:t}=e;return t===n})),r=o?.changelog||"";return r?(0,g.BX)(f,{children:[(0,g.BX)(y,{children:[(0,a._N)("New in version [version]",{version:o.id}),":"]}),(0,g.tZ)("div",{dangerouslySetInnerHTML:{__html:(0,l.Z)(r)}})]}):null},choices:e=>{let{groupingConfigs:t}=e;return t.map((e=>{let{id:t,hidden:n}=e;return[t.toString(),(0,g.tZ)(i.B,{isHidden:n,children:t},t)]}))},help:(0,a.t)("Sets the grouping algorithm to be used for new events."),visible:e=>{let{features:t}=e;return t.has("set-grouping-config")}},d={fingerprintingRules:{name:"fingerprintingRules",type:"string",label:(0,a.t)("Fingerprint Rules"),hideLabel:!0,placeholder:(0,a.t)("error.type:MyException -> fingerprint-value\nstack.function:some_panic_function -> fingerprint-value"),multiline:!0,monospace:!0,autosize:!0,inline:!1,maxRows:20,saveOnBlur:!1,saveMessageAlertType:"info",saveMessage:(0,a.t)("Changing fingerprint rules will apply to future events only (can take up to a minute)."),formatMessageValue:!1,help:()=>(0,g.BX)(r.Fragment,{children:[(0,g.tZ)(m,{children:(0,a._N)("This can be used to modify the fingerprint rules on the server with custom rules.\n        Rules follow the pattern [pattern]. To learn more about fingerprint rules, [docs:read the docs].",{pattern:(0,g.tZ)("code",{children:"matcher:glob -> fingerprint, values"}),docs:(0,g.tZ)(s.Z,{href:"https://docs.sentry.io/product/data-management-settings/event-grouping/fingerprint-rules/"})})}),(0,g.tZ)(h,{children:"# force all errors of the same type to have the same fingerprint\nerror.type:DatabaseUnavailable -> system-down\n# force all memory allocation errors to be grouped together\nstack.function:malloc -> memory-allocation-error"})]}),visible:!0},groupingEnhancements:{name:"groupingEnhancements",type:"string",label:(0,a.t)("Stack Trace Rules"),hideLabel:!0,placeholder:(0,a.t)("stack.function:raise_an_exception ^-group\nstack.function:namespace::* +app"),multiline:!0,monospace:!0,autosize:!0,inline:!1,maxRows:20,saveOnBlur:!1,saveMessageAlertType:"info",saveMessage:(0,a.t)("Changing stack trace rules will apply to future events only (can take up to a minute)."),formatMessageValue:!1,help:()=>(0,g.BX)(r.Fragment,{children:[(0,g.tZ)(m,{children:(0,a._N)("This can be used to enhance the grouping algorithm with custom rules.\n        Rules follow the pattern [pattern]. To learn more about stack trace rules, [docs:read the docs].",{pattern:(0,g.tZ)("code",{children:"matcher:glob [v^]?[+-]flag"}),docs:(0,g.tZ)(s.Z,{href:"https://docs.sentry.io/product/data-management-settings/event-grouping/stack-trace-rules/"})})}),(0,g.tZ)(h,{children:"# remove all frames above a certain function from grouping\nstack.function:panic_handler ^-group\n# mark all functions following a prefix in-app\nstack.function:mylibrary_* +app"})]}),validate:()=>[],visible:!0},groupingConfig:u,secondaryGroupingConfig:{...u,name:"secondaryGroupingConfig",label:(0,a.t)("Fallback/Secondary Grouping Config"),help:(0,a.t)("Sets the secondary grouping algorithm that should be run in addition to avoid creating too many new groups. Controlled by expiration date below."),saveMessage:(0,a.t)("Changing the secondary grouping strategy will affect how many new issues are created.")},secondaryGroupingExpiry:{name:"secondaryGroupingExpiry",type:"number",label:(0,a.t)("Expiration date of secondary grouping"),help:(0,a.t)("If this UNIX timestamp is in the past, the secondary grouping configuration stops applying automatically."),saveOnBlur:!1,saveMessageAlertType:"info",saveMessage:(0,a.t)("Changing the expiration date will affect how many new issues are created.")},groupingAutoUpdate:{name:"groupingAutoUpdate",type:"boolean",label:(0,a.t)("Automatically Update Grouping"),saveOnBlur:!1,help:(0,a.t)("When enabled projects will in the future automatically update to the latest grouping algorithm. Right now this setting does nothing."),saveMessage:e=>{let{value:t}=e;return t?(0,a.t)("Enabling automatic upgrading will take effect on the next incoming event once auto updating has been rolled out."):(0,a.t)("Disabling auto updates will cause you to no longer receive improvements to the grouping algorithm.")}}},m=(0,o.Z)("div",{target:"e1t016b83"})("margin-bottom:",(0,p.D)(1),";margin-top:-",(0,p.D)(1),";margin-right:36px;"),h=(0,o.Z)("pre",{target:"e1t016b82"})("margin-bottom:",(0,p.D)(1),";margin-right:36px;"),f=(0,o.Z)("div",{target:"e1t016b81"})("position:relative;top:-1px;margin-bottom:-1px;padding:",(0,p.D)(2),";border-bottom:1px solid ",(e=>e.theme.innerBorder),";background:",(e=>e.theme.backgroundSecondary),";font-size:",(e=>e.theme.fontSizeMedium),";&:last-child{border:0;border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";}"),y=(0,o.Z)("h3",{target:"e1t016b80"})("font-size:",(e=>e.theme.fontSizeMedium),";margin-bottom:",(0,p.D)(.75),"!important;")},"./app/utils/routeTitle.tsx":(e,t,n)=>{n.d(t,{Z:()=>o});const o=function(e,t){let n=arguments.length>3?arguments[3]:void 0;const o=`${e} - ${t}`,r=n?`${o} - ${n}`:o;return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?r:`${r} - Sentry`}},"./app/views/asyncView.tsx":(e,t,n)=>{n.d(t,{Z:()=>s});var o=n("./app/components/asyncComponent.tsx"),r=n("./app/components/sentryDocumentTitle.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class s extends o.Z{getTitle(){return""}render(){return(0,i.tZ)(r.Z,{title:this.getTitle(),children:this.renderComponent()})}}s.displayName="AsyncView"},"./app/views/settings/project/permissionAlert.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var o=n("./app/components/acl/access.tsx"),r=n("./app/components/alert.tsx"),i=n("./app/locale.tsx"),s=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,i.t)("These settings can only be edited by users with the organization-level owner, manager, or team-level admin roles.");function p(e){let{access:t=["project:write"],project:n,team:i,...p}=e;return(0,s.tZ)(o.Z,{access:t,project:n,team:i,children:e=>{let{hasAccess:t}=e;return!t&&(0,s.tZ)(r.bZ,{"data-test-id":"project-permission-alert",type:"warning",...p,children:a})}})}p.displayName="PermissionAlert";const l=p},"./app/views/settings/projectIssueGrouping/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/react/index.js"),i=n("./app/components/acl/access.tsx"),s=n("./app/components/acl/feature.tsx"),a=n("./app/components/forms/form.tsx"),p=n("./app/components/forms/jsonForm.tsx"),l=n("./app/components/links/externalLink.tsx"),g=n("./app/data/forms/projectIssueGrouping.tsx"),c=n("./app/locale.tsx"),u=n("./app/stores/projectsStore.tsx"),d=n("./app/utils/routeTitle.tsx"),m=n("./app/views/asyncView.tsx"),h=n("./app/views/settings/components/settingsPageHeader.tsx"),f=n("./app/views/settings/components/text/textBlock.tsx"),y=n("./app/views/settings/project/permissionAlert.tsx"),b=n("./app/actionCreators/indicator.tsx"),v=n("./app/components/alert.tsx"),x=n("./app/components/button.tsx"),Z=n("./app/components/confirm.tsx"),w=n("./app/components/forms/fieldGroup/index.tsx"),j=n("./app/components/panels/index.tsx"),k=n("./app/utils/handleXhrErrorResponse.tsx"),C=n("./app/utils/marked.tsx"),T=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const _="upgrade-grouping";function G(e){let{groupingConfigs:t,organization:n,projectId:o,project:i,onUpgrade:s,api:a,location:p}=e;const l=n.access.includes("project:write"),{updateNotes:g,riskLevel:d,latestGroupingConfig:m}=function(e,t){const n={};let o="",r=0,i=null;if(t.forEach((t=>{n[t.id]=t,t.latest&&e.groupingConfig!==t.id&&(o=t.changelog,i=t,r=t.risk)})),i){let t=i.base??"";for(;t!==e.groupingConfig;){const e=n[t];if(!e)break;r=Math.max(r,e.risk),o=e.changelog+"\n"+o,t=e.base??""}}return{updateNotes:o,riskLevel:r,latestGroupingConfig:i}}(i,t),{riskNote:h,alertType:y}=function(e){switch(e){case 0:return{riskNote:(0,c.t)("This upgrade has the chance to create some new issues."),alertType:"info"};case 1:return{riskNote:(0,c.t)("This upgrade will create some new issues."),alertType:"warning"};case 2:return{riskNote:(0,T.tZ)("strong",{children:(0,c.t)("The new grouping strategy is incompatible with the current and will create entirely new issues.")}),alertType:"error"};default:return{riskNote:void 0,alertType:void 0}}}(d),G=i.groupingAutoUpdate||!m,S=d>=2?"danger":"primary";if((0,r.useEffect)((()=>{p.hash===`#${_}`&&!G&&t&&l&&B()}),[p.hash]),!t)return null;async function U(){const e={};if(m){const t=Math.floor((new Date).getTime()/1e3),n=7776e3;e.groupingConfig=m.id,e.secondaryGroupingConfig=i.groupingConfig,e.secondaryGroupingExpiry=t+n}(0,b.E3)((0,c.t)("Changing groupingâ€¦"));try{const t=await a.requestPromise(`/projects/${n.slug}/${o}/`,{method:"PUT",data:e});(0,b.B8)(),u.Z.onUpdateSuccess(t),s()}catch(e){(0,k.X)("Unable to upgrade config",e)}}function B(){(0,Z._)({confirmText:(0,c.t)("Upgrade"),priority:S,onConfirm:U,message:(0,T.BX)(r.Fragment,{children:[(0,T.tZ)(f.Z,{children:(0,T.tZ)("strong",{children:(0,c.t)("Upgrade Grouping Strategy")})}),(0,T.tZ)(f.Z,{children:(0,c.t)("You can upgrade the grouping strategy to the latest but this is an irreversible operation.")}),(0,T.BX)(f.Z,{children:[(0,T.tZ)("strong",{children:(0,c.t)("New Behavior")}),(0,T.tZ)("div",{dangerouslySetInnerHTML:{__html:(0,C.Z)(g)}})]}),(0,T.tZ)(f.Z,{children:(0,T.tZ)(v.bZ,{type:y,children:h})})]})})}return(0,T.BX)(j.s_,{id:_,children:[(0,T.tZ)(j.V9,{children:(0,c.t)("Upgrade Grouping")}),(0,T.tZ)(j.N,{children:(0,T.tZ)(w.Z,{label:(0,c.t)("Upgrade Grouping Strategy"),help:(0,c._N)("If the project uses an old grouping strategy an update is possible.[linebreak]Doing so will cause new events to group differently.",{linebreak:(0,T.tZ)("br",{})}),disabled:!0,children:(0,T.tZ)("div",{children:(0,T.tZ)(x.zx,{onClick:B,disabled:!l||G,title:i.groupingAutoUpdate?(0,c.t)("Disabled because automatic upgrading is enabled"):l?G?(0,c.t)("You are already on the latest version"):void 0:(0,c.t)("You do not have sufficient permissions to do this"),priority:S,children:(0,c.t)("Upgrade Grouping Strategy")})})})})]})}G.displayName="UpgradeGrouping";const S=G;class U extends m.Z{constructor(){super(...arguments),(0,o.Z)(this,"handleSubmit",(e=>{u.Z.onUpdateSuccess(e)}))}getTitle(){const{projectId:e}=this.props.params;return(0,d.Z)((0,c.t)("Issue Grouping"),e,!1)}getDefaultState(){return{...super.getDefaultState(),groupingConfigs:[]}}getEndpoints(){const{organization:e,project:t}=this.props;return[["groupingConfigs",`/projects/${e.slug}/${t.slug}/grouping-configs/`]]}renderBody(){const{groupingConfigs:e}=this.state,{organization:t,project:n,params:o,location:u}=this.props,d=`/projects/${t.slug}/${n.slug}/`,m=new Set(t.access.concat(n.access)),b=(0,i.d)(["project:write"],{organization:t,project:n}),v={additionalFieldProps:{organization:t,groupingConfigs:e},features:new Set(t.features),access:m,disabled:!b};return(0,T.BX)(r.Fragment,{children:[(0,T.tZ)(h.Z,{title:(0,c.t)("Issue Grouping")}),(0,T.tZ)(f.Z,{children:(0,c._N)("All events have a fingerprint. Events with the same fingerprint are grouped together into an issue. To learn more about issue grouping, [link: read the docs].",{link:(0,T.tZ)(l.Z,{href:"https://docs.sentry.io/product/data-management-settings/event-grouping/"})})}),(0,T.tZ)(y.Z,{project:n}),(0,T.BX)(a.Z,{saveOnBlur:!0,allowUndo:!0,initialData:n,apiMethod:"PUT",apiEndpoint:d,onSubmitSuccess:this.handleSubmit,children:[(0,T.tZ)(p.Z,{...v,title:(0,c.t)("Fingerprint Rules"),fields:[g.fields.fingerprintingRules]}),(0,T.tZ)(p.Z,{...v,title:(0,c.t)("Stack Trace Rules"),fields:[g.fields.groupingEnhancements]}),(0,T.tZ)(s.Z,{features:["set-grouping-config"],organization:t,children:(0,T.tZ)(p.Z,{...v,title:(0,c.t)("Change defaults"),fields:[g.fields.groupingConfig,g.fields.secondaryGroupingConfig,g.fields.secondaryGroupingExpiry]})}),(0,T.tZ)(p.Z,{...v,title:(0,c.t)("Automatic Grouping Updates"),fields:[g.fields.groupingAutoUpdate]}),(0,T.tZ)(S,{groupingConfigs:e??[],organization:t,projectId:o.projectId,project:n,api:this.api,onUpgrade:this.fetchData,location:u})]})]})}}const B=U}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_projectIssueGrouping_index_tsx.5ab5a7ffb568807d8cdea9094eec5b6e.js.map