@p2g.must_be(
"(     addr=20,                  )",
"  #20= 150.",
"( sa = Fixed[[1, 2, 3.14, 4, 5, 6], addr=40])",
"  #40= 1.",
"  #41= 2.",
"  #42= 3.14",
"  #43= 4.",
"  #44= 5.",
"  #45= 6.",
"( for j in range[3]:            )",
"  #109= 0.",
"N1000",
"  IF [#109 GE 3.] GOTO 1002",
"(     ptr[j.var + 2] = [j + 2] ** 2 + 17)",
"  #[#109 + 402]= POW[#109 + 2.,2.] + 17.",
"  #109= #109 + 1.",
"  GOTO 1000",
"N1002",
)

def test_const_deref_addresses():
    st = add_some_symbols()
    ptrb = st.txyz

    idx = p2g.Fixed(
        150,
        addr=20,
    )

    sa = p2g.Fixed([1, 2, 3.14, 4, 5, 6], addr=40)
    ptr = p2g.Fixed[100](addr=400)

    j = p2g.Fixed(addr=10)
    for j in range(3):
        ptr[j.var + 2] = (j + 2) ** 2 + 17
